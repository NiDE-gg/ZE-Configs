;--------------------------------------------------------------------
;STRIPPER CFG BY MOLTARD http://steamcommunity.com/id/0123456789ABC/
;--------------------------------------------------------------------
;FIX STAGE2 EDGING BOSS AREA
;----------------------------

modify:
{
	match:
	{
		"classname" "func_brush"
		"targetname" "dira_pevnost_brush"
		"origin" "-9910 475 302.5"
		"model" "*118"
		"hammerid" "3192"
	}
	replace:
	{
		"origin" "-9910 450 302.5"
	}
}

;-------------------------
;FIX STAGE5 GLITCH KRAKEN
;-------------------------

add:
{
	"targetname" "kraken_hurt"
	"hammerid" "139092"
	"classname" "trigger_hurt"
	"model" "*305"
	"nodmgforce" "0"
	"damagemodel" "0"
	"spawnflags" "1"
	"damagetype" "0"
	"StartDisabled" "1"
	"origin" "2395 -11801 -1171.5"
	"damage" "450000"
	"damagecap" "20"
}

;--------------------------------------------------------------
;MAKE BARBOSSA ZOMBIE AFFECTED BY MEDAILLION WHEN BOSSES START
;--------------------------------------------------------------

; Naming the physboxes

modify:
{
	match:
	{
		"origin" "-12367 14768.3 -836.5"
		"classname" "func_physbox_multiplayer"
	}
	insert:
	{
		"targetname" "zombie_barbossa_physbox"
	}
}
modify:
{
	match:
	{
		"origin" "-12358 14776.5 -836.5"
		"classname" "func_physbox_multiplayer"
	}
	insert:
	{
		"targetname" "zombie_barbossa_physbox"
	}
}
modify:
{
	match:
	{
		"origin" "-12367 14784.8 -836.5"
		"classname" "func_physbox_multiplayer"
	}
	insert:
	{
		"targetname" "zombie_barbossa_physbox"
	}
}
modify:
{
	match:
	{
		"origin" "-12376 14776.5 -836.5"
		"classname" "func_physbox_multiplayer"
	}
	insert:
	{
		"targetname" "zombie_barbossa_physbox"
	}
}

; Safe System to reset Barbossa damage filter

add:
{
	"classname" "logic_branch"
	"targetname" "Branch_BarbossaMedaillion"
	"origin" "-12360.5 14778.5 -887.75"
	"InitialValue" "0"
	"OnFalse" "!activator,SetDamageFilter,anti_medailon,0,-1"
	"OnTrue" "!activator,SetDamageFilter,,0,-1"
	"OnUser1" "!self,SetValue,1,0,1"
	"OnUser1" "zombie_barbossa_predek,Enable,,0.1,1"
	"OnUser1" "zombie_barbossa_zadek,Enable,,0.1,1"
	"OnUser1" "zombie_barbossa_prava,Enable,,0.1,1"
	"OnUser1" "zombie_barbossa_leva,Enable,,0.1,1"
	"OnUser1" "zombie_barbossa_predek,Disable,,0.2,1"
	"OnUser1" "zombie_barbossa_zadek,Disable,,0.2,1"
	"OnUser1" "zombie_barbossa_prava,Disable,,0.2,1"
	"OnUser1" "zombie_barbossa_leva,Disable,,0.2,1"
	"OnUser1" "barbossa_player,SetDamageFilter,,0.25,1"
	"OnUser1" "zombie_barbossa_predek,Kill,,0.5,1"
	"OnUser1" "zombie_barbossa_zadek,Kill,,0.5,1"
	"OnUser1" "zombie_barbossa_prava,Kill,,0.5,1"
	"OnUser1" "zombie_barbossa_leva,Kill,,0.5,1"
	"OnUser1" "zombie_barbossa_physbox,Kill,,0.5,1"
	"OnUser1" "barbossa_player,SetDamageFilter,,2.00,1"
	"OnUser1" "barbossa_player,Addoutput,targetname nic,2.10,1"
}

modify:
{
	match:
	{
		"targetname" "zombie_barbossa_predek"
		"classname" "trigger_push"
	}
	delete:
	{
		"OnStartTouch" "!activator,SetDamageFilter,anti_medailon,0,-1"
	}
	insert:
	{
		"OnStartTouch" "Branch_BarbossaMedaillion,Test,,0,-1"
	}
}
modify:
{
	match:
	{
		"targetname" "zombie_barbossa_zadek"
		"classname" "trigger_push"
	}
	delete:
	{
		"OnStartTouch" "!activator,SetDamageFilter,anti_medailon,0,-1"
	}
	insert:
	{
		"OnStartTouch" "Branch_BarbossaMedaillion,Test,,0,-1"
	}
}
modify:
{
	match:
	{
		"targetname" "zombie_barbossa_prava"
		"classname" "trigger_push"
	}
	delete:
	{
		"OnStartTouch" "!activator,SetDamageFilter,anti_medailon,0,-1"
	}
	insert:
	{
		"OnStartTouch" "Branch_BarbossaMedaillion,Test,,0,-1"
	}
}
modify:
{
	match:
	{
		"targetname" "zombie_barbossa_leva"
		"classname" "trigger_push"
	}
	delete:
	{
		"OnStartTouch" "!activator,SetDamageFilter,anti_medailon,0,-1"
	}
	insert:
	{
		"OnStartTouch" "Branch_BarbossaMedaillion,Test,,0,-1"
	}
}



modify:
{
	match:
	{
		"targetname" "barbossa_start"
		"origin" "-1527 14776 -543"
		"classname" "trigger_once"
	}
	insert:
	{
		"OnStartTouch" "Branch_BarbossaMedaillion,FireUser1,,14.5,1"
	}
}

modify:
{
	match:
	{
		"targetname" "set_mapa5"
		"origin" "-3817.5 15095 -1171.37"
		"classname" "trigger_once"
	}
	insert:
	{
		"OnStartTouch" "Branch_BarbossaMedaillion,FireUser1,,21.5,1"
	}
}


;-----------
;KRAKEN GOD
;-----------

;++++++++++++
;Level Start
;++++++++++++

add:
{
	"origin" "-2644 5723 -600"
	"targetname" "saving_relay6"
	"StartDisabled" "0"
	"spawnflags" "0"
	"classname" "logic_relay"
	"hammerid" "8114098"
	"OnUser1" "saving_brush,AddOutput,OnUser1 saving_relay6:trigger::0:1,0.01,-1"
	"OnUser1" "saving_brush,FireUser1,,0,-1"
	"OnUser1" "saving_brush,FireUser1,,0,-1"
	"OnUser1" "saving_brush,FireUser1,,0,-1"
	"OnUser1" "saving_brush,FireUser1,,0,-1"
	"OnTrigger" "saving_relay*,Disable,,0.01,-1"
	"OnTrigger" "saving_brush,AddOutput,OnUser1 saving_relay6:trigger::0:1,0,-1"
	"OnTrigger" "zombie_barbossa_vchod,Break,,14,-1"
	"OnTrigger" "zombie_hp_timer,Enable,,10,-1"
	"OnTrigger" "dvere_spawn,Open,,6,-1"
	"OnTrigger" "bb_template3,ForceSpawn,,1,-1"
	"OnTrigger" "bb_template2,ForceSpawn,,1,-1"
	"OnTrigger" "bb_template,ForceSpawn,,1,-1"
	"OnTrigger" "lvl5_1,PlaySound,,1,-1"
	"OnTrigger" "jack_final_template,ForceSpawn,,0.5,-1"
	"OnTrigger" "consola,Command,zr_infect_mzombie_ratio 7,0.5,-1"
	"OnTrigger" "template_spawn_5_5,ForceSpawn,,0.5,-1"
	"OnTrigger" "consola,Command,zr_infect_spawntime_min 8,0.5,-1"
	"OnTrigger" "consola,Command,zr_infect_spawntime_max 8,0.5,-1"
	"OnTrigger" "consola,Command,zr_respawn_delay 1,0.5,-1"
	"OnTrigger" "consola,Command,zr_respawn 1,0.5,-1"
	"OnTrigger" "jack_track*,Kill,,0,-1"
	"OnTrigger" "4lvl_lavka,Kill,,0,-1"
	"OnTrigger" "trigger_first,Kill,,0,-1"
	"OnTrigger" "anti_spawn_pf_2,Enable,,0,-1"
	"OnTrigger" "zataaras_spawn,Kill,,0,-1"
	"OnTrigger" "sky_barak,Break,,0,-1"
	"OnTrigger" "voda_44_55_2_sky,Toggle,,0,-1"
	"OnTrigger" "level4_multiple,Kill,,0,-1"
	"OnTrigger" "voda_44_55_sky,Toggle,,0,-1"
	"OnTrigger" "port_case_medailon,PickRandom,,0,-1"
	"OnTrigger" "port_level5,Trigger,,0,-1"
	"OnTrigger" "lvl4_2,Kill,,0,-1"
	"OnTrigger" "lvl4_1,Kill,,0,-1"
	"OnTrigger" "once_5,Enable,,0,-1"
	"OnTrigger" "dvere_mapa3,Break,,0,-1"
	"OnTrigger" "prekazka_most1,Lock,,0,-1"
	"OnTrigger" "jack_track_train,Kill,,0,-1"
	"OnTrigger" "jack_model,Kill,,0,-1"
	"OnTrigger" "zatarasa_predvesnici,Break,,0,-1"
	"OnTrigger" "dvere_mapa3,Break,,0,-1"
	"OnTrigger" "dvere_mapa3,Break,,0,-1"
	"OnTrigger" "map_spawn_cerno,Disable,,0,-1"
	"OnTrigger" "stiny_envi,TurnOn,,0,-1"
	"OnTrigger" "map_spawn_temno,Disable,,0,-1"
	"OnTrigger" "map_spawn_den,Enable,,0,-1"
	"OnTrigger" "map_spawn_mraky,TurnOff,,0,-1"
	"OnTrigger" "text_test,Display,,10.01,1"
	"OnTrigger" "text_test,AddOutput,color 255 255 0,10,1"
	"OnTrigger" "text_test,AddOutput,message >>> |LEVEL 5 KRAKEN GOD!| <<<,10,1"
	"OnTrigger" "text_test,Display,,5.01,1"
	"OnTrigger" "text_test,AddOutput,message Map made by Puklica,5,1"
	"OnTrigger" "text_test,AddOutput,color 0 128 255,5,1"
	"OnTrigger" "consola,Command,say >>> |LEVEL 5 KRAKEN GOD!| <<<,10,1"
	"OnTrigger" "consola,Command,say Map made by Puklica,5,1"
	"OnTrigger" "Branch_Lvl5Win,SetValue,1,0,1"
	"OnTrigger" "kraken_rtv,Enable,,1,1"
	"OnTrigger" "kraken_zacatek_god,Enable,,0,-1"
	"OnTrigger" "kraken_zacatek,Kill,,0,-1"
}

;+++++++++++
;Boss Fight
;+++++++++++

add:
{
	"origin" "1990.28 -11596.3 -841"
	"targetname" "kraken_rtv"
	"StartDisabled" "1"
	"spawnflags" "0"
	"classname" "logic_relay"
	"hammerid" "14089694"
	"OnTrigger" "consola,Command,say >>> KRAKEN GOD! <<<,0,1"
	"OnTrigger" "consola,Command,say >>> KRAKEN GOD! <<<,1,1"
	"OnTrigger" "consola,Command,say >>> KRAKEN GOD! <<<,2,1"
}

modify:
{
	match:
	{
		"targetname" "kraken_path1"
		"classname" "path_track"
	}
	insert:
	{
		"OnPass" "consola,Command,say >>> IT'S KRAKEN. KILL HIM! <<<,6,-1"
		"OnPass" "kraken_zacatek_god,Trigger,,8,-1"
		"OnPass" "kraken_rtv,Trigger,,0,1"
	}
}

modify:
{
	match:
	{
		"targetname" "kraken_hp_iterations"
		"classname" "math_counter"
	}
	insert:
	{
		"OnHitMin" "kraken_zacatek_god,CancelPending,,0,-1"
	}
}
add:
{
	"origin" "2126 -12336 -936.609"
	"targetname" "kraken_zacatek_god"
	"StartDisabled" "1"
	"spawnflags" "0"
	"classname" "logic_relay"
	"hammerid" "14002753"
	"OnTrigger" "kraken_utok_random,PickRandom,,0,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,4.7,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,9.4,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,14.1,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,18.8,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,23.5,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,28.2,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,51.7,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,37.6,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,42.3,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,32.9,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,70.5,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,61.1,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,65.8,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,75.2,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,79.9,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,47,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,56.4,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,84.6,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,89.3,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,94,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,98.7,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,103.4,-1"
	"OnTrigger" "kraken_utok_random,PickRandom,,108.1,-1"
	"OnTrigger" "kraken_dead_all,Trigger,,114,-1"
}

;++++++++++
;Level End
;++++++++++

add:
{
	"classname" "logic_branch"
	"targetname" "Branch_Lvl5Win"
	"origin" "9723 -12767 -1160.67"
	"InitialValue" "0"
	"OnFalse" "consola,Command,say >>> YOU HAVE WON THE MAP. BUT ONLY EASY KRAKEN <<< ,0,1"	
	"OnFalse" "text_test,AddOutput,message YOU HAVE WON THE MAP. BUT ONLY EASY KRAKEN ,0,1"
	
	"OnTrue" "consola,Command,say >>> YOU KILLED GOD KRAKEN AND WON THE MAP,0,0"
	"OnTrue" "text_test,AddOutput,message YOU KILLED GOD KRAKEN AND WON THE MAP,0,1"
	"OnTrue" "consola,Command,say >>> YOU ARE A REAL PIRATE! <<< ,2,1"
	"OnTrue" "text_test,AddOutput,message  YOU ARE A REAL PIRATE! ,2,1"
	"OnTrue" "text_test,Display,,2.01,1"
}


modify:
{
	match:
	{
		"targetname" "level_5_win"
		"classname" "logic_relay"
	}
	delete:
	{
		"OnTrigger" "text_test,AddOutput,message YOU HAVE WON THE MAP. YOU ARE A REAL PIRATE ,0,1"
		"OnTrigger" "saving_relay5,FireUser1,,0,-1"
	}
	insert:
	{
		"OnTrigger" "Branch_Lvl5Win,Test,,0,1"
		"OnTrigger" "saving_relay6,FireUser1,,0,-1"
	}
}


;-----------------------------
;CONSOLE MESSAGES (LIKE V5.4)
;-----------------------------

;++++++++++++
;Boss Attack
;++++++++++++

modify:
{
	match:
	{
		"targetname" "kraken_utok2"
		"classname" "logic_relay"
	}
	insert:
	{
		"OnTrigger" "consola,Command,say ||| KRAKEN HAS USED VORTEX |||,0,-1"
	}
}

modify:
{
	match:
	{
		"targetname" "kraken_utok3"
		"classname" "logic_relay"
	}
	insert:
	{
		"OnTrigger" "consola,Command,say  ||| KRAKEN HAS THROWN BARREL ON YOU |||,0,-1"
	}
}

modify:
{
	match:
	{
		"targetname" "kraken_utok3double"
		"classname" "logic_relay"
	}
	insert:
	{
		"OnTrigger" "consola,Command,say  ||| KRAKEN HAS THROWN BARRELS ON YOU |||,0,-1"
	}
}
modify:
{
	match:
	{
		"targetname" "kraken_utok4"
		"classname" "logic_relay"
	}
	insert:
	{
		"OnTrigger" "consola,Command,say  ||| KRAKEN HAS SENT A WAVE ON YOU |||,0,-1"	
	}
}
modify:
{
	match:
	{
		"targetname" "kraken_utok5"
		"classname" "logic_relay"
	}
	insert:
	{
		"OnTrigger" "consola,Command,say  ||| KRAKEN HAS SENT A BUBBLES ON YOU |||,0,-1"
	}
}

;++++++++++++
;Level Start
;++++++++++++

modify:
{
	match:
	{
		"targetname" "saving_relay1"
		"classname" "logic_relay"
	}
	insert:
	{
		"OnTrigger" "consola,Command,say >>> |LEVEL 1| <<<,10,1"
		"OnTrigger" "consola,Command,say Map made by Puklica,5,1"
	}
}
modify:
{
	match:
	{
		"targetname" "saving_relay2"
		"classname" "logic_relay"
	}
	insert:
	{
		"OnTrigger" "consola,Command,say >>> |LEVEL 2| <<<,10,1"
		"OnTrigger" "consola,Command,say Map made by Puklica,5,1"
	}
}
modify:
{
	match:
	{
		"targetname" "saving_relay3"
		"classname" "logic_relay"
	}
	insert:
	{
		"OnTrigger" "consola,Command,say >>> |LEVEL 3| <<<,10,1"
		"OnTrigger" "consola,Command,say Map made by Puklica,5,1"
	}
}
modify:
{
	match:
	{
		"targetname" "saving_relay4"
		"classname" "logic_relay"
	}
	insert:
	{
		"OnTrigger" "consola,Command,say >>> |LEVEL 4| <<<,10,1"
		"OnTrigger" "consola,Command,say Map made by Puklica,5,1"
	}
}
modify:
{
	match:
	{
		"targetname" "saving_relay5"
		"classname" "logic_relay"
	}
	insert:
	{
		"OnTrigger" "consola,Command,say >>> |LEVEL 5| <<<,10,1"
		"OnTrigger" "consola,Command,say Map made by Puklica,5,1"
	}
}
;fix crashing players on stage 1 when they finished the stage
filter:
{
"model" "*78"
"wait" "1"
"targetname" "perla_hit_25"
"StartDisabled" "1"
"spawnflags" "1"
"origin" "-12249.5 533.06 -1092"
"classname" "trigger_multiple"
"hammerid" "2823"
}
filter:
{
"origin" "-12446 921.4 -1117"
"UseRandomTime" "0"
"UpperRandomBound" "0"
"targetname" "anti_perla"
"StartDisabled" "1"
"spawnflags" "0"
"RefireTime" "3"
"LowerRandomBound" "0"
"classname" "logic_timer"
"hammerid" "2720"
}
modify:
{
	match:
	{
		"targetname" "jack_vezeni_path13"
		"classname" "path_track"
	}
	delete:
	{
		"OnPass" "anti_respawn,Enable,,87,1"
		"OnPass" "anti_perla,Enable,,52,1"
	}
	insert:
	{
		"OnPass" "anti_respawn,Enable,,55,1"
}