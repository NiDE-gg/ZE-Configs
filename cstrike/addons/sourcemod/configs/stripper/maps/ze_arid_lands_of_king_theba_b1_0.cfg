;ze_arid_lands_of_king_theba_b1_0 -- Stripper fixes -- Last Updated May 12th, 2024
;Thanks to NiDE for helping with testing the map before and after Stripper changes were made.

;------------------
; General Stuff
;------------------

;Spawns an extra radar template to reset the effects of Jammer in case a template radar isn't in the map at the moment Jammer is used.

modify:
{
	match:
	{
		"targetname" "item_radar_jammer_filter"
	}
	insert:
	{
		"OnPass" "template_radar_maker,ForceSpawnAtEntityOrigin,item_radar_jammer_button,8.05,-1"
	}
}

;------------------
; Stage 1
;------------------

;Filters out the prop_dynamics used in the Detonator item and replaces them with an info_teleport_destination entity

filter:
{
	"classname" "prop_dynamic"
	"targetname" "item_detonator_exp_spawner_l"
}

filter:
{
	"classname" "prop_dynamic"
	"targetname" "item_detonator_exp_spawner_r"
}

add:
{
	"origin" "-7456 8576 -2016"
	"targetname" "item_detonator_exp_spawner_l"
	"parentname" "item_detonator_prop"
	"angles" "0 270 0"
	"classname" "info_teleport_destination"
	
	"OnUser1" "explosion_huge_maker,ForceSpawnAtEntityOrigin,!caller,0.05,1"
}

add:
{
	"origin" "-8480 8576 -2016"
	"targetname" "item_detonator_exp_spawner_r"
	"parentname" "item_detonator_prop"
	"angles" "0 270 0"
	"classname" "info_teleport_destination"
	
	"OnUser1" "explosion_huge_maker,ForceSpawnAtEntityOrigin,!caller,0.05,1"
}

;Adds a clone of the zm trigger at the Dunes section to apply fog to humans as it's currently not long enough to cover both TPs

add:
{
	"model" "*174"
	"targetname" "s1_dunes_hold1_fog_human_alt"
	"wait" "1"
	"StartDisabled" "0"
	"origin" "11136 -14656 -10080"
	"spawnflags" "1"
	"filtername" "main_filter_humans"
	"classname" "trigger_multiple"
	
	"OnStartTouch" "!activator,SetFogController,main_fog_humans,0,-1"
}

;Applies the nuke_ignore filter in the teleport after the funny to ensure everyone gets it

modify:
{
	match:
	{
		"targetname" "s1_post_end_tp_humans"
	}
	insert:
	{
		"OnStartTouch" "!activator,SetDamageFilter,nuke_ignore,0,-1"
	}
}

;Adds a push trigger that I meant to add before but forgor skull emoji

add:
{
	"model" "*80"
	"targetname" "s1_oasis_hold7_push_zm"
	"StartDisabled" "1"
	"speed" "450"
	"spawnflags" "1"
	"pushdir" "0 135 0"
	"origin" "2400 -1520 768"
	"filtername" "main_filter_zombies"
	"alternateticksfix" "0"
	"classname" "trigger_push"
}

modify:
{
	match:
	{
		"targetname" "s1_oasis_hold7_trigger"
	}
	insert:
	{
		"OnTrigger" "s1_oasis_hold7_push_zm,Enable,,32,1"
		"OnTrigger" "s1_oasis_hold7_push_zm,Kill,,36,1"
	}
}

;Changes some outputs on Dunes to apply fades only once

modify:
{
	match:
	{
		"targetname" "s1_aos_hold5_fade"
	}
	delete:
	{
		"OnStartTouch" "s1_fade_to_dunes,Fade,,0,-1"
	}
	insert:
	{
		"OnStartTouch" "s1_fade_to_dunes,Fade,,0,1"
	}
}

modify:
{
	match:
	{
		"targetname" "s1_dunes_run_trigger"
	}
	delete:
	{
		"OnStartTouch" "s1_fade_to_dunes,Fade,,2,-1"
	}
	insert:
	{
		"OnStartTouch" "s1_fade_to_dunes,Fade,,2,1"
	}
}