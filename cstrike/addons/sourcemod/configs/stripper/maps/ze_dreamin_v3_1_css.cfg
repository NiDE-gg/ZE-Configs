;REPLACE EXISTING PHYSICS LEVEL SYSTEM WITH PERM ENTS
add:
{
	"classname" "math_counter"
	"targetname" "stage_counter"
	"max" "4"
	"min" "1"
	"StartDisabled" "0"
	"startvalue" "1"
	"OnGetValue" "stage_case,InValue,,0,-1"
}

add:
{
	"classname" "point_template"
	"targetname" "stage_system_template"
	"Template01" "stage_counter"
	"spawnflags" "2"
}

add:
{
	"classname" "info_target"
	"targetname" "stage_counter_init"
	"spawnflags" "0"
	"OnUser1" "stage_system_template,ForceSpawn,,0,-1"
	"OnUser1" "stage_counter,AddOutput,classname info_target,0.03,-1"
	"OnUser1" "!self,Kill,,0.06,-1"
}

add:
{
	"classname" "logic_case"
	"targetname" "stage_case"
	"Case01" "1"
	"Case02" "2"
	"Case03" "3"
	"case04" "4"
	"OnCase01" "st1_trigger,Trigger,,0.2,1"
	"OnCase02" "st2_trigger,Trigger,,0.2,1"
	"OnCase03" "st3_trigger,Trigger,,0.2,1"
	"OnCase04" "st4_trigger,Trigger,,0.2,1"
}

modify:
{
	match:
	{
		"classname" "logic_auto"
	}
	insert:
	{
		"OnMapSpawn" "stage_counter_init,FireUser1,,0,-1"
		"OnMapSpawn" "stage_counter,GetValue,,0.02,-1"
	}
}

modify:
{
	match:
	{
		"classname" "func_button"
		"hammerid" "620997"
	}
	delete:
	{
		"OnPressed" "brush_*,Enable,,0,-1"
		"OnPressed" "brush_4,Disable,,0.1,-1"
	}
	insert:
	{
		"OnPressed" "stage_counter,SetValue,4,0,-1"
	}
}

modify:
{
	match:
	{
		"classname" "func_button"
		"hammerid" "381766"
	}
	delete:
	{
		"OnPressed" "brush_*,Enable,,0,-1"
		"OnPressed" "brush_3,Disable,,0.1,-1"
	}
	insert:
	{
		"OnPressed" "stage_counter,SetValue,3,0,-1"
	}
}

modify:
{
	match:
	{
		"classname" "func_button"
		"hammerid" "254143"
	}
	delete:
	{
		"OnPressed" "brush_*,Enable,,0,-1"
		"OnPressed" "brush_2,Disable,,0.1,-1"
	}
	insert:
	{
		"OnPressed" "stage_counter,SetValue,2,0,-1"
	}
}

modify:
{
	match:
	{
		"classname" "func_button"
		"hammerid" "254149"
	}
	delete:
	{
		"OnPressed" "brush_*,Enable,,0,-1"
		"OnPressed" "brush_1,Disable,,0.1,-1"
	}
	insert:
	{
		"OnPressed" "stage_counter,SetValue,1,0,-1"
	}
}

modify:
{
	match:
	{
		"classname" "trigger_multiple"
		"targetname" "st3_clear"
	}
	delete:
	{
		"OnStartTouch" "brush_*,Enable,,0,-1"
		"OnStartTouch" "brush_4,Disable,,1,-1"
	}
	insert:
	{
		"OnStartTouch" "stage_counter,SetValue,4,0,-1"
	}
}

modify:
{
	match:
	{
		"classname" "trigger_once"
		"hammerid" "381778"
	}
	delete:
	{
		"OnStartTouch" "brush_3,Disable,,0.1,1"
		"OnStartTouch" "brush_*,Enable,,0,1"
	}
	insert:
	{
		"OnStartTouch" "stage_counter,SetValue,3,0,-1"
	}
}

modify:
{
	match:
	{
		"classname" "trigger_multiple"
		"targetname" "clear_trigger"
	}
	delete:
	{
		"OnStartTouch" "brush_2,Disable,,0.1,-1"
		"OnStartTouch" "brush_*,Enable,,0,-1"
	}
	insert:
	{
		"OnStartTouch" "stage_counter,SetValue,2,0,-1"
	}
}

;cleanup old physics level system
filter:
{
	"classname" "func_brush"
	"targetname" "/brush_.*/"
}

filter:
{
	"classname" "trigger_once"
	"targetname" "/trigger_\d/"
}


;boss health adjustment (v2 had 50)
modify:
{
	match:
	{
		"targetname" "boss_teleport"
		"classname" "trigger_teleport"
		"hammerid" "22046"
	}
	delete:
	{
		"OnStartTouch" "HPCounter2,Add,80,0,-1"
	}
	insert:
	{
		"OnStartTouch" "HPCounter2,Add,70,0,-1"
	}
}

;boss health adjustment (v2 had 50)
modify:
{
	match:
	{
		"targetname" "hp_counter_set"
		"classname" "trigger_multiple"
		"hammerid" "11290"
	}
	delete:
	{
		"OnStartTouch" "hpcounter2,Add,80,0,-1"
	}
	insert:
	{
		"OnStartTouch" "hpcounter2,Add,70,0,-1"
	}
}

;boss health adjustment (v2 had 500)
modify:
{
	match:
	{
		"targetname" "st3_goto"
		"classname" "trigger_multiple"
		"hammerid" "386278"
	}
	delete:
	{
		"OnStartTouch" "st3_hp,Add,700,0,-1"
	}
	insert:
	{
		"OnStartTouch" "st3_hp,Add,600,0,-1"
	}
}

;fuck you henry
modify:
{
	match:
	{
		"classname"    "trigger_push"
		"targetname" "final_slow_push"
	}
	insert:
	{
		"OnStartTouch" "cmd,Command,sv_airaccelerate 15,0,1"
		"OnStartTouch" "cmd,Command,sv_accelerate 8,0,1"
	}
}

modify:
{
	match:
	{
		"classname" "logic_auto"
	}
	insert:
	{
		"OnMapSpawn" "cmd,Command,sv_airaccelerate 9.6,0,1"
		"OnMapSpawn" "cmd,Command,sv_accelerate 5,0,1"
	}
}

;FIX COUNTDOWN TEXT CONFLICTING WITH PLUGIN
modify:
{
	match:
	{
		"classname" "game_text"
		"targetname" "seconds_left"
		"hammerid" "331889"
	}
	replace:
	{
		"channel" "2"
	}
}