;
; Stripper CFG by koen (STEAM_1:1:114921174)
;                 .Rushaway
;

;==================================================
; Offliner Stages
;==================================================
; RTV 1
; RTV 2 (Piano RTV)
; RTV 3
; RTV 4
;==================================================

;==================================================
; Dynamic shadow crash fix
;==================================================
modify:
{
    match:
    {
        "targetname" "move_rtv2_boss_ikura_2"
        "classname" "func_door"
    }
    replace:
    {
        "disablereceiveshadows" "1"
        "disableshadows" "1"
    }
}
modify:
{
    match:
    {
        "targetname" "move_st3_boss_ikura_2"
        "classname" "func_door"
    }
    replace:
    {
        "disablereceiveshadows" "1"
        "disableshadows" "1"
    }
}

;==================================================
; Fix boss counter bug
;==================================================

; kill rtv boss counter on stage 4 and vice versa
modify:
{
    match:
    {
        "targetname" "newlv_relay_4"
        "classname" "logic_relay"
    }
    insert:
    {
        "OnTrigger" "counter_rtv_boss_vida,Kill,,0,-1"
    }
}

; these seems to be switched for some reason?
modify:
{
    match:
    {
        "targetname" "newlv_relay_rtv"
        "classname" "logic_relay"
    }
    insert:
    {
        "OnTrigger" "counter_st4_boss_vida,Kill,,0,-1"
    }
}
modify:
{
    match:
    {
        "targetname" "newlv_relay_rtv2"
        "classname" "logic_relay"
    }
    insert:
    {
        "OnTrigger" "counter_st4_boss_vida,Kill,,0,-1"
        "OnTrigger" "counter_rtv_boss_vida,Kill,,0,-1"
    }
}

;==================================================
; Set default air acceleration
;==================================================
modify:
{
    match:
    {
        "hammerid" "69325"
        "classname" "logic_auto"
    }
    delete:
    {
        "OnMapSpawn" "sc,Command,sv_airaccelerate 5,0,-1"
    }
}

;==================================================
; Replace existing physics level system with permanent entities
;==================================================
add:
{
    "classname" "point_template"
    "targetname" "level_system_template"
    "Template01" "level_counter"
    "spawnflags" "2"
}
add:
{
    "classname" "info_target"
    "targetname" "level_counter_init"
    "spawnflags" "0"
    "OnUser1" "level_system_template,ForceSpawn,,0,-1"
    "OnUser1" "level_counter,AddOutput,classname info_target,0.03,-1"
    "OnUser1" "!self,Kill,,0.06,-1"
}
add:
{
    "classname" "math_counter"
    "targetname" "level_counter"
    "max" "8"
    "min" "1"
    "startvalue" "1"
    "StartDisabled" "0"
    "OnGetValue" "level_case,InValue,,0,-1"
}
add:
{
    "classname" "logic_case"
    "targetname" "level_case"
    "Case01" "1"
    "Case02" "2"
    "Case03" "3"
    "Case04" "4"
    "Case05" "5"
    "Case06" "6"
    "case07" "7"
    "Case08" "8"

    ; stage 2
    "OnCase02" "zombie_item_trigger*,Kill,,1,-1"
    "OnCase02" "beam_st3_boss,Kill,,0,-1"
    "OnCase02" "move_l1_st4_block_1,Kill,,0,-1"
    "OnCase02" "break_start_left,Kill,,0,-1"
    "OnCase02" "brush_st4_last_sky,Disable,,0,-1"
    "OnCase02" "relay_rtv_first_trigger,Kill,,0,-1"
    "OnCase02" "l4_first_trigger,Kill,,0,-1"
    "OnCase02" "rot_st4_last_sc_white,Kill,,0,-1"
    "OnCase02" "l1_dust,TurnOff,,0,-1"
    "OnCase02" "l1_white_2,Kill,,0,-1"
    "OnCase02" "l1_rots_1,Kill,,0,-1"
    "OnCase02" "move_1,Kill,,0,-1"
    "OnCase02" "l1_white_1_break,Kill,,0,-1"
    "OnCase02" "white_1,Kill,,0,-1"
    "OnCase02" "l2_first_trigger,Enable,,0,-1"
    "OnCase02" "l1_first_trigger,Kill,,0,-1"

    ; stage 3
    "OnCase03" "zombie_item_trigger_1,Enable,,1,-1"
    "OnCase03" "zombie_item_trigger_2,Enable,,1,-1"
    "OnCase03" "zombie_item_trigger_3,Kill,,1,-1"
    "OnCase03" "maker_start_item2,ForceSpawnAtEntityOrigin,maker_start_item2,1,-1"
    "OnCase03" "maker_start_item3,ForceSpawnAtEntityOrigin,maker_start_item3,1,-1"
    "OnCase03" "relay_motherzm_count,Enable,,0,-1"
    "OnCase03" "beam_st3_boss,TurnOn,,0,-1"
    "OnCase03" "move_l1_st4_block_1,Kill,,0,-1"
    "OnCase03" "break_l3_boss_zombie_asiba,Disable,,0,-1"
    "OnCase03" "break_start_left,Kill,,0,-1"
    "OnCase03" "brush_st4_last_sky,Disable,,0,-1"
    "OnCase03" "relay_rtv_first_trigger,Kill,,0,-1"
    "OnCase03" "l4_first_trigger,Kill,,0,-1"
    "OnCase03" "rot_st4_last_sc_white,Kill,,0,-1"
    "OnCase03" "l1_dust,Kill,,0,-1"
    "OnCase03" "white_1,Kill,,0,-1"
    "OnCase03" "l1_white_1_break,Kill,,0,-1"
    "OnCase03" "move_1,Kill,,0,-1"
    "OnCase03" "l1_rots_1,Kill,,0,-1"
    "OnCase03" "l1_white_2,Kill,,0,-1"
    "OnCase03" "l3_first_trigger,Enable,,0,-1"
    "OnCase03" "l2_first_trigger,Kill,,0,-1"
    "OnCase03" "l1_first_trigger,Kill,,0,-1"

    ; stage 4
    "OnCase04" "maker_start_item3,ForceSpawnAtEntityOrigin,maker_start_item3,1,-1"
    "OnCase04" "maker_start_item2,ForceSpawnAtEntityOrigin,maker_start_item2,1,-1"
    "OnCase04" "zombie_item_trigger*,Enable,,1,-1"
    "OnCase04" "maker_start_item1,ForceSpawnAtEntityOrigin,maker_start_item1,1,-1"
    "OnCase04" "relay_motherzm_count,Enable,,0,-1"
    "OnCase04" "l4_last_white_5,Kill,,0,-1"
    "OnCase04" "l4_last_white_4,Kill,,0,-1"
    "OnCase04" "l4_last_white_3,Kill,,0,-1"
    "OnCase04" "l4_last_white_2,Kill,,0,-1"
    "OnCase04" "l4_last_white_1,Kill,,0,-1"
    "OnCase04" "l1_stairs_2,Kill,,0,-1"
    "OnCase04" "once_st3_left_end,Kill,,0,-1"
    "OnCase04" "once_st3_right_end,Kill,,0,-1"
    "OnCase04" "l4_last_door_*,Kill,,0,-1"
    "OnCase04" "white_boss_circle_rot_*,Kill,,0,-1"
    "OnCase04" "white_boss_circle_move_*,Kill,,0,-1"
    "OnCase04" "white_boss_laser_*,Kill,,0,-1"
    "OnCase04" "boss_lifebar_*,Kill,,0,-1"
    "OnCase04" "l4_boss_lifebar_*,Kill,,0,-1"
    "OnCase04" "l4_boss_random_beam_*,Kill,,0,-1"
    "OnCase04" "l4_boss_under_rot_*,Kill,,0,-1"
    "OnCase04" "l4_boss_top_rot_*,Kill,,0,-1"
    "OnCase04" "l4_boss_all_c_brushes,Kill,,0,-1"
    "OnCase04" "l4_boss_c_c_lr__2,Kill,,0,-1"
    "OnCase04" "l4_boss_c_c_lr__2,Kill,,0,-1"
    "OnCase04" "l4_boss_c_c_lr_1,Kill,,0,-1"
    "OnCase04" "beam_st3_boss,Kill,,0,-1"
    "OnCase04" "break_start_left,Kill,,0,-1"
    "OnCase04" "brush_st4_last_sky,Enable,,0,-1"
    "OnCase04" "relay_rtv_first_trigger,Kill,,0,-1"
    "OnCase04" "relay_st4_heal_enable,Trigger,,0,-1"
    "OnCase04" "ilu_st4_boss_ato_black,Enable,,0,-1"
    "OnCase04" "bgm1,Kill,,0,-1"
    "OnCase04" "l3_first_trigger,Kill,,0,-1"
    "OnCase04" "l2_first_trigger,Kill,,0,-1"
    "OnCase04" "l4_first_trigger,Enable,,0,-1"
    "OnCase04" "l1_first_trigger,Kill,,0,-1"
    "OnCase04" "physbox_st4_boss_zombie_asiba,Disable,,0,-1"

    ; rtv 1 (rtv2 in entities)
    "OnCase05" "maker_start_item3,ForceSpawnAtEntityOrigin,maker_start_item3,1,-1"
    "OnCase05" "maker_start_item2,ForceSpawnAtEntityOrigin,maker_start_item2,1,-1"
    "OnCase05" "zombie_item_trigger*,Enable,,1,-1"
    "OnCase05" "maker_start_item1,ForceSpawnAtEntityOrigin,maker_start_item1,1,-1"
    "OnCase05" "rot_st3_boss_ikura,Kill,,0,-1"
    "OnCase05" "move_st3_boss_rot_move_*,Kill,,0,-1"
    "OnCase05" "physbox_st4_boss_zombie_asiba,Disable,,0,-1"
    "OnCase05" "maker_st4_heal_spawn,ForceSpawnAtEntityOrigin,target_heal_point_2,0,-1"
    "OnCase05" "relay_motherzm_count,Enable,,0,-1"
    "OnCase05" "l4_last_white_5,Kill,,0,-1"
    "OnCase05" "l4_last_white_4,Kill,,0,-1"
    "OnCase05" "l4_last_white_3,Kill,,0,-1"
    "OnCase05" "l4_last_white_2,Kill,,0,-1"
    "OnCase05" "l4_last_white_1,Kill,,0,-1"
    "OnCase05" "l1_stairs_2,Kill,,0,-1"
    "OnCase05" "once_st3_left_end,Kill,,0,-1"
    "OnCase05" "once_st3_right_end,Kill,,0,-1"
    "OnCase05" "l4_last_door_*,Kill,,0,-1"
    "OnCase05" "white_boss_circle_rot_*,Kill,,0,-1"
    "OnCase05" "white_boss_circle_move_*,Kill,,0,-1"
    "OnCase05" "white_boss_laser_*,Kill,,0,-1"
    "OnCase05" "boss_lifebar_*,Kill,,0,-1"
    "OnCase05" "l4_boss_lifebar_*,Kill,,0,-1"
    "OnCase05" "l4_boss_random_beam_*,Kill,,0,-1"
    "OnCase05" "l4_boss_under_rot_*,Kill,,0,-1"
    "OnCase05" "l4_boss_top_rot_*,Kill,,0,-1"
    "OnCase05" "l4_boss_all_c_brushes,Kill,,0,-1"
    "OnCase05" "l4_boss_c_c_lr__2,Kill,,0,-1"
    "OnCase05" "l4_boss_c_c_lr__2,Kill,,0,-1"
    "OnCase05" "l4_boss_c_c_lr_1,Kill,,0,-1"
    "OnCase05" "beam_st3_boss,Kill,,0,-1"
    "OnCase05" "break_start_left,Kill,,0,-1"
    "OnCase05" "brush_st4_last_sky,Disable,,0,-1"
    "OnCase05" "relay_rtv_first_trigger,Kill,,0,-1"
    "OnCase05" "relay_st4_heal_enable,Trigger,,0,-1"
    "OnCase05" "ilu_st4_boss_ato_black,Enable,,0,-1"
    "OnCase05" "bgm1,Kill,,0,-1"
    "OnCase05" "l3_first_trigger,Kill,,0,-1"
    "OnCase05" "l2_first_trigger,Kill,,0,-1"
    "OnCase05" "l4_first_trigger,Kill,,0,-1"
    "OnCase05" "l1_first_trigger,Kill,,0,-1"
    "OnCase05" "relay_rtv2_start,Enable,,0,-1"
    "OnCase05" "rot_st4_last_white_rot,Kill,,0,-1"
    "OnCase05" "bgm_rtv2_first,PlaySound,,0,-1"
    "OnCase05" "rtv_timer,Enable,,0,-1"

    ; rtv 2
    "OnCase06" "break_start_left,Kill,,0,-1"
    "OnCase06" "rtv_timer,Enable,,0,-1"
    "OnCase06" "relay_st4_boss_push,Enable,,0,-1"
    "OnCase06" "relay_st4_boss_guruguru,Enable,,0,-1"
    "OnCase06" "relay_st4_boss_asimoto_dokkan_start,Enable,,0,-1"
    "OnCase06" "relay_st4_boss_go_lasers_start,Enable,,0,-1"
    "OnCase06" "relay_st4_boss_lines_start,Enable,,0,-1"
    "OnCase06" "relay_st4_boss_vortex_push,Enable,,0,-1"
    "OnCase06" "relay_st4_boss_disco,Enable,,0,-1"
    "OnCase06" "relay_rtv_first_trigger,Enable,,0,-1"
    "OnCase06" "relay_rtv_heal_enable,Trigger,,0,-1"
    "OnCase06" "maker_st4_heal_spawn,ForceSpawnAtEntityOrigin,target_heal_point_2,0,-1"
    "OnCase06" "ilu_st4_boss_ato_black,Enable,,0,-1"
    "OnCase06" "bgm1,Kill,,0,-1"
    "OnCase06" "l3_first_trigger,Kill,,0,-1"
    "OnCase06" "l2_first_trigger,Kill,,0,-1"
    "OnCase06" "l4_first_trigger,Kill,,0,-1"
    "OnCase06" "l1_first_trigger,Kill,,0,-1"
    "OnCase06" "physbox_st4_boss_zombie_asiba,Disable,,0,-1"

    ;rtv 3
    "OnCase07" "relay_rtv3_init,Trigger,,0,-1"

    ;rtv 4
    "OnCase08" "rtv4_init,Trigger,,0,-1"
}
modify:
{
    match:
    {
        "classname" "logic_auto"
    }
    insert:
    {
        "OnMapSpawn" "level_counter_init,FireUser1,,0,1"
        "OnMapSpawn" "level_counter,GetValue,,0.1,1"
    }
}

;==================================================
; Change existing stage change triggers to the new system
;==================================================
modify:
{
    match:
    {
        "targetname" "admin_go_level1"
    }
    delete:
    {
        "OnPressed" "nlv_relay_2,Disable,,0,-1"
        "OnPressed" "nlv_relay_3,Disable,,0,-1"
        "OnPressed" "nlv_relay_4,Disable,,0,-1"
        "OnPressed" "nlv_relay_rtv,Disable,,0,-1"
        "OnPressed" "nlv_relay_rtv2,Disable,,0,-1"
    }
    insert:
    {
        "OnPressed" "level_counter,SetValueNoFire,1,0,-1"
    }
}
modify:
{
    match:
    {
        "targetname" "admin_go_level2"
    }
    delete:
    {
        "OnPressed" "nlv_relay_rtv2,Disable,,0,-1"
        "OnPressed" "nlv_relay_rtv,Disable,,0,-1"
        "OnPressed" "nlv_relay_4,Disable,,0,-1"
        "OnPressed" "nlv_relay_3,Disable,,0,-1"
        "OnPressed" "nlv_relay_2,Enable,,0,-1"
    }
    insert:
    {
        "OnPressed" "level_counter,SetValueNoFire,2,0,-1"
    }
}
modify:
{
    match:
    {
        "targetname" "admin_go_level2_sec"
    }
    delete:
    {
        "OnPressed" "nlv_relay_rtv2,Disable,,0,-1"
        "OnPressed" "nlv_relay_rtv,Disable,,0,-1"
        "OnPressed" "nlv_relay_4,Disable,,0,-1"
        "OnPressed" "nlv_relay_3,Enable,,0,-1"
        "OnPressed" "nlv_relay_2,Disable,,0,-1"
    }
    insert:
    {
        "OnPressed" "level_counter,SetValueNoFire,3,0,-1"
    }
}
modify:
{
    match:
    {
        "targetname" "admin_go_level4"
    }
    delete:
    {
        "OnPressed" "nlv_relay_rtv2,Disable,,0,-1"
        "OnPressed" "nlv_relay_rtv,Disable,,0,-1"
        "OnPressed" "nlv_relay_4,Enable,,0,-1"
        "OnPressed" "nlv_relay_3,Disable,,0,-1"
        "OnPressed" "nlv_relay_2,Disable,,0,-1"
    }
    insert:
    {
        "OnPressed" "level_counter,SetValueNoFire,4,0,-1"
    }
}
modify:
{
    match:
    {
        "targetname" "admin_go_rtv"
    }
    delete:
    {
        "OnPressed" "nlv_relay_rtv2,Disable,,0,-1"
        "OnPressed" "nlv_relay_rtv,Enable,,0,-1"
        "OnPressed" "nlv_relay_4,Disable,,0,-1"
        "OnPressed" "nlv_relay_3,Disable,,0,-1"
        "OnPressed" "nlv_relay_2,Disable,,0,-1"
    }
    insert:
    {
        "OnPressed" "level_counter,SetValueNoFire,5,0,-1"
    }
}
modify:
{
    match:
    {
        "targetname" "admin_go_rtv2"
    }
    delete:
    {
        "OnPressed" "nlv_relay_rtv2,Enable,,0,-1"
        "OnPressed" "nlv_relay_rtv,Disable,,0,-1"
        "OnPressed" "nlv_relay_4,Disable,,0,-1"
        "OnPressed" "nlv_relay_3,Disable,,0,-1"
        "OnPressed" "nlv_relay_2,Disable,,0,-1"
        "OnPressed" "nlv_relay_rtv2_e,Disable,,0,-1"
    }
    insert:
    {
        "OnPressed" "level_counter,SetValueNoFire,6,0,-1"
    }
}
modify:
{
    match:
    {
        "targetname" "l1_clear_check_human"
    }
    delete:
    {
        "OnStartTouch" "nlv_relay_2,Enable,,0,-1"
    }
    insert:
    {
        "OnTrigger" "level_counter,SetValueNoFire,2,0,1"
    }
}
modify:
{
    match:
    {
        "targetname" "once_l2_win"
    }
    delete:
    {
        "OnStartTouch" "nlv_relay_2,Disable,,0,-1"
        "OnStartTouch" "nlv_relay_3,Enable,,0,-1"
    }
    insert:
    {
        "OnTrigger" "level_counter,SetValueNoFire,3,0,1"
    }
}
modify:
{
    match:
    {
        "targetname" "trigger_l3_go_l4"
    }
    delete:
    {
        "OnStartTouch" "nlv_relay_4,Enable,,0,-1"
        "OnStartTouch" "nlv_relay_3,Disable,,0,-1"
        "OnStartTouch" "nlv_relay_2,Disable,,0,-1"
    }
    insert:
    {
        "OnTrigger" "level_counter,SetValueNoFire,4,0,1"
    }
}
modify:
{
    match:
    {
        "targetname" "getscore"
    }
    delete:
    {
        "OnStartTouch" "nlv_relay_2,Disable,,0,-1"
        "OnStartTouch" "nlv_relay_3,Disable,,0,-1"
        "OnStartTouch" "nlv_relay_4,Disable,,0,-1"
        "OnStartTouch" "nlv_relay_rtv2,Enable,,0,-1"
        "OnStartTouch" "nlv_relay_rtv,Disable,,0,-1"
    }
    insert:
    {
        "OnStartTouch" "level_counter,SetValueNoFire,5,0,1"
    }
}
modify:
{
    match:
    {
        "targetname" "trigger_rtv2_win"
    }
    insert:
    {
        "OnStartTouch" "level_counter,SetValueNoFire,6,0,1"
    }
}

;==================================================
; Cleanup old level system
;==================================================
modify:
{
    match:
    {
        "classname" "logic_auto"
    }
    delete:
    {
        "OnMapSpawn" "nlv_*,FireUser1,,0.05,-1"
        "OnMapSpawn" "newlv_*,FireUser2,,0.1,-1"
        "OnMapSpawn" "nlv_*,Trigger,,0.1,-1"
    }
}
filter:
{
    "targetname" "/^newlv_.*/"
}

;==================================================
; Fix teleport avoidance spot and exploit
;==================================================

; Fix stage 4/rtv/rtv2 teleport exploit
modify:
{
    match:
    {
        "targetname" "teleport_st4_boss_zm_spawn"
        "classname" "trigger_teleport"
    }
    replace:
    {
        "origin" "3332 3204 600"
    }
}

; Fix stage 4/rtv/rtv2 teleport avoidance spot
add:
{
    "model" "*74"
    "UseLandmarkAngles" "1"
    "targetname" "teleport_st4_last_otita"
    "target" "destination_st4_boss_zm"
    "spawnflags" "4097"
    "origin" "-10760 2453 -15212"
    "CheckDestIfClearForPlayer" "0"
    "classname" "trigger_teleport"
}

;   ____  ______ ______ _      _____ _   _ ______ _____
;  / __ \|  ____|  ____| |    |_   _| \ | |  ____|  __ \
; | |  | | |__  | |__  | |      | | |  \| | |__  | |__) |
; | |  | |  __| |  __| | |      | | | . ` |  __| |  _  /
; | |__| | |    | |    | |____ _| |_| |\  | |____| | \ \
;  \____/|_|    |_|    |______|_____|_| \_|______|_|  \_\

;==================================================
; Setup shared rtv entities
;==================================================

; Add rtv stage buttons in admin room
add:
{
    "wait" "3"
    "unlocked_sound" "0"
    "unlocked_sentence" "0"
    "targetname" "admin_go_rtv3"
    "speed" "5"
    "spawnflags" "1024"
    "sounds" "0"
    "rendermode" "0"
    "renderfx" "0"
    "rendercolor" "192 192 192"
    "renderamt" "255"
    "origin" "272 2234 6408"
    "movedir" "90 0 0"
    "model" "*598"
    "min_use_angle" "0.8"
    "locked_sound" "0"
    "locked_sentence" "0"
    "lip" "0"
    "health" "0"
    "fadescale" "1"
    "fademindist" "-1"
    "fademaxdist" "0"
    "disablereceiveshadows" "0"
    "classname" "func_button"
    "OnPressed" "sc,Command,say *** RTV3 ***,0,-1"
    "OnPressed" "level_counter,SetValueNoFire,7,0.1,1"
}
add:
{
    "wait" "3"
    "unlocked_sound" "0"
    "unlocked_sentence" "0"
    "targetname" "admin_go_rtv4"
    "speed" "5"
    "spawnflags" "1024"
    "sounds" "0"
    "rendermode" "0"
    "renderfx" "0"
    "rendercolor" "192 192 192"
    "renderamt" "255"
    "origin" "224 2234 6408"
    "movedir" "90 0 0"
    "model" "*598"
    "min_use_angle" "0.8"
    "locked_sound" "0"
    "locked_sentence" "0"
    "lip" "0"
    "health" "0"
    "fadescale" "1"
    "fademindist" "-1"
    "fademaxdist" "0"
    "disablereceiveshadows" "0"
    "classname" "func_button"
    "OnPressed" "sc,Command,say *** RTV4 ***,0,-1"
    "OnPressed" "level_counter,SetValueNoFire,8,0.1,1"
}

;move existing rtv stage buttons in admin room
modify:
{
    match:
    {
        "targetname" "admin_go_rtv"
    }
    replace:
    {
        "origin" "368 2234 6408"
    }
}
modify:
{
    match:
    {
        "targetname" "admin_go_rtv2"
    }
    replace:
    {
        "origin" "320 2234 6408"
    }
}

;add worldhint for rtv stages
add:
{
    "origin" "368 2234 6432"
    "viewer" "0"
    "targetname" "rtv_hint"
    "range" "600"
    "hint" "RTV"
    "classname" "point_worldhint"
}
add:
{
    "origin" "320 2234 6432"
    "viewer" "0"
    "targetname" "rtv2_hint"
    "range" "600"
    "hint" "RTV2"
    "classname" "point_worldhint"
}
add:
{
    "origin" "272 2234 6432"
    "viewer" "0"
    "targetname" "rtv3_hint"
    "range" "600"
    "hint" "RTV3"
    "classname" "point_worldhint"
}
add:
{
    "origin" "224 2234 6432"
    "viewer" "0"
    "targetname" "rtv4_hint"
    "range" "600"
    "hint" "RTV4"
    "classname" "point_worldhint"
}


;==================================================
; Add RTV 3
;==================================================

; Add rtv3 music
add:
{
    "classname" "ambient_generic"
    "cspinup" "0"
    "fadeinsecs" "0"
    "fadeoutsecs" "0"
    "health" "10"
    "lfomodpitch" "0"
    "lfomodvol" "0"
    "lforate" "0"
    "lfotype" "0"
    "message" "#koen/gris/grievouslady_fix.mp3"
    "pitch" "100"
    "pitchstart" "100"
    "preset" "0"
    "radius" "1250"
    "spawnflags" "49"
    "spindown" "0"
    "spinup" "0"
    "targetname" "bgm_rtv3"
    "volstart" "0"
}

; Add rtv3 relay
modify:
{
    match:
    {
        "targetname" "first_trigger"
    }
    insert:
    {
        "OnStartTouch" "relay_rtv3_first_trigger,Trigger,,0,1"
    }
}
add:
{
    "classname" "logic_relay"
    "targetname" "relay_rtv3_init"
    "spawnflags" "2"
    "StartDisabled" "0"
    "OnTrigger" "l1_first_trigger,Kill,,0,-1"
    "OnTrigger" "l2_first_trigger,Kill,,0,-1"
    "OnTrigger" "l3_first_trigger,Kill,,0,-1"
    "OnTrigger" "l4_first_trigger,Kill,,0,-1"
    "OnTrigger" "relay_rtv2_start,Kill,,0,-1"
    "OnTrigger" "relay_rtv_first_trigger,Kill,,0,-1"
    "OnTrigger" "relay_rtv3_first_trigger,Enable,,0,-1"
    "OnTrigger" "bgm_rtv2_first,PlaySound,,0,1"
    "OnTrigger" "bgm1,Kill,,0,1"
}

; Add rtv3 main relay
add:
{
    "classname" "logic_relay"
    "targetname" "relay_rtv3_boss_attack_start"
    "spawnflags" "1"
    "StartDisabled" "0"

    ; enable all boss skill relays (except zombie tp)
    "OnTrigger" "relay_st4_boss_case_return,Kill,,0,-1"
    "OnTrigger" "relay_st4_boss_under_circle,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_guruguru,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_vortex,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_push,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_vortex_push,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_go_lasers,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_go_lasers_back,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_circle_lasers,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_ikura_spawn,Enable,,0,-1"
    ;"OnTrigger" "relay_st4_boss_zombie_ring,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_asimoto_dokkan_start,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_lines_start,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_disco,Enable,,0,-1"

    ; start rtv3 music!! The soul of this stage!!
    "OnTrigger" "bgm_rtv3,PlaySound,,0,-1"

    ; disco attack, offset -3s
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,1.61,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,2.76,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,3.89,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,5.08,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,6.14,-1"

    "OnTrigger" "fade_white,Fade,,16,-1"
    "OnTrigger" "relay_rtv3_boss_disco_end,Trigger,,16,-1"

    ;meteor attacks
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,18.3,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,18.7,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,19.1,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,19.5,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,20.05,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,20.3,-1"

    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,20.58,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,21.0,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,21.4,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,21.8,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,22.30,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,22.61,-1"

    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,22.83,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,23.3,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,23.7,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,24.1,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,24.61,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,24.93,-1"

    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,25.14,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,25.57,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,25.95,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,26.39,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,26.86,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,27.18,-1"

    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,27.39,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,27.82,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,28.26,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,28.70,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,29.18,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,29.49,-1"

    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,29.7,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,30.1,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,30.5,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,31,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,31.49,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,31.80,-1"

    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,31.95,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,32.45,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,32.89,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,33.26,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,33.74,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,34.05,-1"

    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,34.26,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,34.70,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,35.08,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,35.49,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,36.05,-1"

    ; onion ring lasers
    "OnTrigger" "se20,PlaySound,,35.8,-1"
    "OnTrigger" "timer_st4_boss_lines,Enable,,35.8,-1"

    ; random push/pull attack
    "OnTrigger" "st4_boss_cc,Enable,,37.7,-1"
    "OnTrigger" "case_rtv3_boss_vortex_or_push,PickRandom,,38,-1"
    "OnTrigger" "st4_boss_cc,Disable,,41,-1"

    ; spinning lasers + enable cc
    "OnTrigger" "temp_rtv2_under_rot,ForceSpawn,,45.3,-1"
    "OnTrigger" "st4_boss_cc,Enable,,45.3,-1"

    ; random push/pull attack
    "OnTrigger" "st4_boss_cc,Enable,,46.7,-1"
    "OnTrigger" "case_rtv3_boss_vortex_or_push,PickRandom,,47,-1"
    "OnTrigger" "st4_boss_cc,Disable,,50,-1"

    ; end onion ring lasers + end spinning lasers + disable cc
    "OnTrigger" "se20,FadeOut,2,53.5,-1"
    "OnTrigger" "timer_st4_boss_lines,Disable,,53.5,-1"
    "OnTrigger" "relay_rtv2_boss_under_rot_killer,Trigger,,54,-1"
    "OnTrigger" "st4_boss_cc,Disable,,54,-1"

    ; pillar laser + rotating square lasers
    "OnTrigger" "relay_rtv3_boss_circle_lasers,Trigger,,54.97,-1"

    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,54.97,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,55.02,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,55.07,-1"

    "OnTrigger" "case_st4_boss_under_circle,PickRandom,,56.03,-1"

    "OnTrigger" "relay_rtv3_boss_circle_lasers,Trigger,,57.06,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,57.06,-1"

    "OnTrigger" "case_st4_boss_under_circle,PickRandom,,58.34,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,58.34,-1"

    "OnTrigger" "relay_rtv3_boss_circle_lasers,Trigger,,59.47,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,59.47,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,59.48,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,59.49,-1"

    "OnTrigger" "case_st4_boss_under_circle,PickRandom,,60.60,-1"

    "OnTrigger" "relay_rtv3_boss_circle_lasers,Trigger,,61.74,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,61.74,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,62.74,-1"

    ; slow pull effect followed by push
    "OnTrigger" "cc_boss,Disable,,63.08,-1"
    "OnTrigger" "st4_boss_cc,Enable,,63.08,-1"
    "OnTrigger" "se4,PlaySound,,64.08,-1"
    "OnTrigger" "push_st4_boss_vortex_*,Enable,,64.33,-1"
    "OnTrigger" "maker_st4_boss_vortex_push_lasers,ForceSpawnAtEntityOrigin,rot_st4_boss_vortex_push,64.08,-1"
    "OnTrigger" "maker_st4_boss_vortex_push_lasers,ForceSpawnAtEntityOrigin,rot_st4_boss_vortex_push,64.33,-1"
    "OnTrigger" "maker_st4_boss_vortex_push_lasers,ForceSpawnAtEntityOrigin,rot_st4_boss_vortex_push,64.64,-1"
    "OnTrigger" "maker_st4_boss_vortex_push_lasers,ForceSpawnAtEntityOrigin,rot_st4_boss_vortex_push,64.96,-1"
    "OnTrigger" "maker_st4_boss_vortex_push_lasers,ForceSpawnAtEntityOrigin,rot_st4_boss_vortex_push,65.20,-1"
    "OnTrigger" "maker_st4_boss_vortex_push_lasers,ForceSpawnAtEntityOrigin,rot_st4_boss_vortex_push,65.52,-1"
    "OnTrigger" "maker_st4_boss_vortex_push_lasers,ForceSpawnAtEntityOrigin,rot_st4_boss_vortex_push,66.08,-1"
    "OnTrigger" "push_st4_boss_vortex_*,Disable,,66.08,-1"
    "OnTrigger" "se4,FadeOut,1,66.08,-1"

    "OnTrigger" "temp_st4_boss_push,ForceSpawn,,65.5,-1"
    "OnTrigger" "se2,PlaySound,,66.33,-1"

    "OnTrigger" "push_st4_boss_push_*,Enable,,66.33,-1"
    "OnTrigger" "push_st4_boss_push_*,Disable,,68.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,66.33,-1"

    "OnTrigger" "move_st4_boss_vortex_push_*,Kill,,66.53,-1"
    "OnTrigger" "relay_st4_boss_vortex_push_lasers,Kill,,66.53,-1"
    "OnTrigger" "laser_st4_boss_vortex_push_*,Kill,,66.53,-1"

    ; disable push/pull + revert cc
    "OnTrigger" "cc_boss,Enable,,66.33,-1"
    "OnTrigger" "st4_boss_cc,Disable,,66.33,-1"

    ; black projectile attack
    "OnTrigger" "cc_boss,Disbale,,66.33,-1"
    "OnTrigger" "st4_boss_cc,Enable,,66.33,-1"
    "OnTrigger" "temp_rtv2_boss_spawn_ikura,ForceSpawn,,66.33,-1"

    ; disco attack, offset -3s
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,72.30,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,73.49,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,74.68,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,76.93,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,78.05,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,79.18,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,81.49,-1"
    "OnTrigger" "relay_rtv3_boss_disco_end,Trigger,,85.74,-1"

    ; end black projectile attack
    "OnTrigger" "relay_rtv2_boss_ikura_killer,Trigger,,82.64,-1"
    "OnTrigger" "cc_boss,Enable,,84,-1"
    "OnTrigger" "st4_boss_cc,Disable,,84,-1"

    ; random meteors
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,86.71,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,87.08,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,87.58,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,88.02,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,88.46,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,88.77,-1"

    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,89.02,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,89.52,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,89.96,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,90.40,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,90.83,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,91.08,-1"

    ; music tempo change section
    "OnTrigger" "relay_st4_boss_go_lasers_pick_back,SetValue,1,91.35,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,91.36,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,91.68,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,91.92,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,92.23,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,91.36,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,91.68,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,91.92,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,92.23,-1"

    "OnTrigger" "relay_st4_boss_go_lasers_pick_back,SetValue,2,92.53,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,92.54,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,92.67,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,92.89,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,92.98,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,92.54,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,92.67,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,92.89,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,92.98,-1"

    ; disable inner meteors + make it blinding (theres nowhere to hide if this isnt done)
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,92.99,-1"

    "OnTrigger" "case_st4_boss_asimoto_dokkan_back,InValue,6,93.00,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back,InValue,7,93.018,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back,InValue,8,93.046,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back,InValue,9,93.074,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back,InValue,10,93.102,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,93.01,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,93.02,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,93.05,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,93.08,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,93.11,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,93.01,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,93.02,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,93.05,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,93.08,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,93.11,-1"

    "OnTrigger" "case_st4_boss_asimoto_dokkan_back_2,InValue,6,93.130,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back_2,InValue,7,93.158,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back_2,InValue,8,93.186,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back_2,InValue,9,93.214,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back_2,InValue,10,93.242,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,93.14,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,93.16,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,93.19,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,93.22,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,93.25,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,93.14,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,93.16,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,93.19,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,93.22,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,93.25,-1"

    "OnTrigger" "case_st4_boss_asimoto_dokkan_back_3,InValue,6,93.470,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back_3,InValue,7,93.498,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back_3,InValue,8,93.526,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back_3,InValue,9,93.554,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back_3,InValue,10,93.582,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,93.48,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,93.50,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,93.53,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,93.56,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,93.60,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,93.48,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,93.50,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,93.53,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,93.56,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,93.60,-1"

    "OnTrigger" "case_st4_boss_asimoto_dokkan_back4,InValue,6,93.610,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back4,InValue,7,93.638,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back4,InValue,8,93.666,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back4,InValue,9,93.694,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_back4,InValue,10,93.722,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,93.62,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,93.64,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,93.68,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,93.70,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,93.73,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,93.62,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,93.64,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,93.68,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,93.70,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,93.73,-1"

    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,93.75,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,94.75,-1"

    ; change of pace + start onion ring lasers
    "OnTrigger" "se20,PlaySound,,95.3,-1"
    "OnTrigger" "timer_st4_boss_lines,Enable,,95.3,-1"
    "OnTrigger" "st4_boss_cc,Enable,,97,-1"
    "OnTrigger" "case_rtv3_boss_vortex_or_push,PickRandom,,97.58,-1"
    "OnTrigger" "case_rtv3_boss_vortex_or_push,PickRandom,,98.70,-1"
    "OnTrigger" "case_rtv3_boss_vortex_or_push,PickRandom,,99.83,-1"
    "OnTrigger" "st4_boss_cc,Disable,,102.83,-1"

    ; end onion ring lasers
    "OnTrigger" "se20,FadeOut,2,104.82,-1"
    "OnTrigger" "timer_st4_boss_lines,Disable,,104.82,-1"

    ; pillar lasers
    "OnTrigger" "relay_rtv3_boss_circle_lasers,Trigger,,105.09,-1"
    "OnTrigger" "relay_rtv3_boss_circle_lasers,Trigger,,106.21,-1"
    "OnTrigger" "relay_rtv3_boss_circle_lasers,Trigger,,107.40,-1"
    "OnTrigger" "relay_rtv3_boss_circle_lasers,Trigger,,108.53,-1"
    "OnTrigger" "relay_rtv3_boss_circle_lasers,Trigger,,109.65,-1"
    "OnTrigger" "relay_rtv3_boss_circle_lasers,Trigger,,110.83,-1"
    "OnTrigger" "relay_rtv3_boss_circle_lasers,Trigger,,111.96,-1"

    ; jump/crouch spinning lasers during pillar lasers
    "OnTrigger" "se1,PlaySound,,102.19,-1"
    "OnTrigger" "temp_st4_boss_guruguru,ForceSpawn,,102.19,-1"

    ; end jump/crouch spinning lasers
    "OnTrigger" "relay_rtv3_boss_guruguru_clean,Trigger,,113.5,-1"

    ; climax 3/4 - 2 random attacks (except zombie cage)
    "OnTrigger" "relay_st4_boss_zombie_ring,Kill,,114,-1"
    "OnTrigger" "case_st4_boss,PickRandomShuffle,,114.8,-1"
    "OnTrigger" "case_st4_boss,PickRandomShuffle,,114.8,-1"

    "OnTrigger" "case_st4_boss,PickRandomShuffle,,119,-1"

    ; climax 4/4 - 2 random attacks (too lazy to time the attacks with the music)
    "OnTrigger" "case_st4_boss,PickRandomShuffle,,123.3,-1"
    "OnTrigger" "case_st4_boss,PickRandomShuffle,,123.3,-1"

    ; enable constant vortex
    "OnTrigger" "se11,PlaySound,,123.3,-1"
    "OnTrigger" "timer_rtv3_boss_vortex_make,Enable,,123.3,-1"
    "OnTrigger" "push_st4_boss_vortex_*,Enable,,124,-1"

    ; disable constant vortex
    "OnTrigger" "timer_rtv3_boss_vortex_make,Disable,,128.5,-1"
    "OnTrigger" "push_st4_boss_vortex_*,Disable,,128.5,-1"

    ; activate push as the song ends
    "OnTrigger" "relay_st4_boss_push,Trigger,,129.5,-1"

    ; cleanup
    "OnTrigger" "move_st4_boss_vortex_push_*,Kill,,130.5,-1"
    "OnTrigger" "relay_st4_boss_vortex_push_lasers,Kill,,130.5,-1"
    "OnTrigger" "laser_st4_boss_vortex_push_*,Kill,,130.5,-1"

    ; nuke
    "OnTrigger" "relay_rtv3_boss_win,Trigger,,137.2,-1"
}

; Add rtv3 relay - generate meteors randomly on every plantform
add:
{
    "classname" "logic_relay"
    "targetname" "relay_rtv3_boss_spawn_circle"
    "spawnflags" "2"
    "StartDisabled" "0"
    "OnTrigger" "case_st4_boss_asimoto_dokkan,PickRandomShuffle,,0,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_2,PickRandomShuffle,,0,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_3,PickRandomShuffle,,0,-1"
    "OnTrigger" "case_st4_boss_asimoto_dokkan_4,PickRandomShuffle,,0,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,0.01,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,0.01,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,0.01,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,0.01,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn,0.01,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_2,0.01,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_3,0.01,-1"
    "OnTrigger" "maker_st4_boss_asimoto_dokkan_ring,ForceSpawnAtEntityOrigin,target_st4_boss_asimoto_dokkan_spawn_4,0.01,-1"
}

; Add rtv3 relay - enable meteor damage
add:
{
    "classname" "logic_relay"
    "targetname" "relay_rtv3_boss_circle_active"
    "spawnflags" "2"
    "StartDisabled" "0"
    "OnTrigger" "laser_se_2,PlaySound,,0,-1"
    "OnTrigger" "fade_white,Fade,,0,-1"
    "OnTrigger" "laser_st4_boss_asimoto_dokkan_1*,TurnOn,,0,-1"
    "OnTrigger" "hurt_st4_boss_asimoto_dokkan*,Enable,,0,-1"
}

; Add rtv3 relay - cleanup meteors
add:
{
    "classname" "logic_relay"
    "targetname" "relay_rtv3_boss_circle_clear"
    "spawnflags" "2"
    "StartDisabled" "0"
    "OnTrigger" "laser_se_2,FadeOut,1,1,-1"
    "OnTrigger" "laser_st4_boss_asimoto_dokkan_1*,Kill,,0,-1"
    "OnTrigger" "hurt_st4_boss_asimoto_dokkan*,Kill,,0,-1"
    "OnTrigger" "relay_st4_boss_asimoto_dokkan*,Kill,,0,-1"
    "OnTrigger" "lasertarget_st4_boss_asimoto_dokkan_1*,Kill,,0,-1"
    "OnTrigger" "move_st4_boss_asimoto_dokkan_2*,Kill,,0,-1"
    "OnTrigger" "move_st4_boss_asimoto_dokkan_1*,Kill,,0,-1"
    "OnTrigger" "relay_st4_boss_asimoto_dokkan_ring*,Kill,,0,-1"
    "OnTrigger" "beam_st4_boss_asimoto_dokkan*,Kill,,0,-1"
}

; Add rtv3 relay - end disco attack
add:
{
    "classname" "logic_relay"
    "targetname" "relay_rtv3_boss_disco_end"
    "spawnflags" "2"
    "StartDisabled" "0"
    "OnTrigger" "laser_se_2,FadeOut,1,0,-1"
    "OnTrigger" "fade_white,Fade,,0,-1"
    "OnTrigger" "beam_st4_boss_disco_*,Kill,,0,-1"
    "OnTrigger" "target_st4_boss_disco_*,Kill,,0,-1"
    "OnTrigger" "move_st4_boss_disco_b*,Kill,,0,-1"
    "OnTrigger" "hurt_st4_boss_disco_*,Kill,,0,-1"
    "OnTrigger" "rot_st4_boss_disco*,Kill,,0,-1"
    "OnTrigger" "relay_st4_boss_disco_activate,Kill,,0,-1"
}

; Add rtv3 relay - generate laser pillars
add:
{
    "classname" "logic_relay"
    "targetname" "relay_rtv3_boss_circle_lasers"
    "spawnflags" "2"
    "StartDisabled" "0"
    "OnTrigger" "fade_white,Fade,,0,-1"
    "OnTrigger" "laser_se_2,PlaySound,,0,-1"
    "OnTrigger" "maker_st4_boss_circle_lasers,ForceSpawnAtEntityOrigin,rot_st4_boss_circle_lasers,0,-1"
}

; Add rtv3 relay - disable jump/crouch spinning lasers
add:
{
    "classname" "logic_relay"
    "targetname" "relay_rtv3_boss_guruguru_clean"
    "spawnflags" "2"
    "StartDisabled" "0"
    "OnTrigger" "hurt_st4_boss_guruguru_*,Kill,,0,-1"
    "OnTrigger" "rot_st4_boss_guruguru,Kill,,0,-1"
    "OnTrigger" "move_st4_boss_guruguru_tb,Kill,,0,-1"
    "OnTrigger" "move_st4_boss_guruguru_*,Kill,,0,-1"
    "OnTrigger" "laser_st4_boss_guruguru_*,Kill,,0,-1"
    "OnTrigger" "target_st4_boss_guruguru_*,Kill,,0,-1"
    "OnTrigger" "relay_st4_boss_guruguru_activate,Kill,,0,-1"
}

; Add rtv3 relay - nuke
add:
{
    "classname" "logic_relay"
    "targetname" "relay_rtv3_boss_win"
    "spawnflags" "2"
    "StartDisabled" "0"
    "OnTrigger" "relay_item_kill,Trigger,,0,-1"
    "OnTrigger" "rot_st4_boss,Kill,,0,-1"
    "OnTrigger" "break_st4_boss_hitbox,Break,,0,-1"
    "OnTrigger" "relay_rtv_first_trigger,CancelPending,,0,-1"
    "OnTrigger" "env_shake,StopShake,,3,-1"
    "OnTrigger" "hurt_rtv_win,Enable,,3,-1"
    "OnTrigger" "sc,command,endround,5,-1"

    ; set to rtv 1
    "OnTrigger" "level_counter,SetValueNoFire,5,5,1"
    ;"OnTrigger" "rtv_physbox_brush,FireUser1,,5,-1"
}

; Add rtv3 relay - vortex attack timer
add:
{
    "classname" "logic_timer"
    "targetname" "timer_rtv3_boss_vortex_make"
    "RefireTime" "0.7"
    "spawnflags" "0"
    "StartDisabled" "1"
    "OnTimer" "maker_st4_boss_vortex_push_lasers,ForceSpawnAtEntityOrigin,rot_st4_boss_vortex_push,0,-1"
}

; Add rtv3 relay - random vortex or push attack
add:
{
    "classname" "logic_case"
    "targetname" "case_rtv3_boss_vortex_or_push"
    "OnCase01" "relay_st4_boss_push,Trigger,,0,-1"
    "OnCase02" "relay_st4_boss_vortex,Trigger,,0,-1"
}

; Add rtv3 relay - trigger relay
add:
{
    "classname" "logic_relay"
    "targetname" "relay_rtv3_first_trigger"
    "spawnflags" "1"
    "StartDisabled" "1"

    "OnTrigger" "relay_st4_boss_kill,Kill,,0,-1"
    "OnTrigger" "relay_st4_boss_teleport_ready,Kill,,0,-1"
    "OnTrigger" "relay_st4_boss_case_return,Kill,,0,-1"
    "OnTrigger" "counter_st4_boss_vida,Kill,,0,-1"
    "OnTrigger" "counter_st4_boss_vida_bar,Kill,,0,-1"

    "OnTrigger" "l4_door_1,Open,,0,-1"
    "OnTrigger" "l4_door_1,Close,,10,-1"
    "OnTrigger" "fade_green,Fade,,10,-1"
    "OnTrigger" "l4_move_1,Open,,12,-1"

    "OnTrigger" "rtv_timer,Disable,,10,-1"

    "OnTrigger" "sc,Command,say *** ... ***,16,-1"
    "OnTrigger" "sc,Command,say *** Still playing ? ***,19,-1"

    "OnTrigger" "fade_black_long,Fade,,23,-1"
    "OnTrigger" "fade_black_long,FadeReverse,,25,-1"
    "OnTrigger" "teleport_st4_boss_zm_spawn,Enable,,25,-1"
    "OnTrigger" "fade_black_long,FadeReverse,,27,-1"
    "OnTrigger" "cc_boss,Enable,,27,-1"
    "OnTrigger" "cc1,Disable,,27,-1"

    ; set human health
    "OnTrigger" "trigger_st4_boss_human_hp_up,AddOutput,OnStartTouch !activator:AddOutput:health 400:0.01:-1,30,1"
    "OnTrigger" "trigger_st4_boss_human_hp_up,Enable,,31,-1"
    "OnTrigger" "trigger_st4_boss_human_hp_up,Disable,,31.9,-1"

    "OnTrigger" "fade_white_15,Fade,,32,-1"
    "OnTrigger" "fade_white_15,FadeReverse,,33.5,-1"
    "OnTrigger" "relay_st4_boss_time_1,Kill,,34,-1"

    ; set next round as rtv3
    "OnTrigger" "level_counter,SetValueNoFire,5,1,1"

    ; fix vortex/push attack being too blinding
    "OnTrigger" "relay_st4_boss_push,AddOutput,OnTrigger cc_boss:Enable::0.6:-1,36,1"
    "OnTrigger" "relay_st4_boss_vortex,AddOutput,OnTrigger cc_boss:Enable::0.1:-1,36,1"
    "OnTrigger" "relay_st4_boss_vortex_push,AddOutput,OnTrigger cc_boss:Enable::0.1:-1,36,1"

    ; modify vortex/push spawnflags
    "OnTrigger" "relay_st4_boss_push,AddOutput,spawnflags 2,36,1"
    "OnTrigger" "relay_st4_boss_vortex,AddOutput,spawnflags 2,36,1"

    "OnTrigger" "bgm_rtv2_first,FadeOut,1,36,-1"

    ; disable zombie respawn to prevent server edict crash
    ;"OnTrigger" "sc,Command,zr_respawn 0,36,-1"

    ; START THE GAME !!!
    "OnTrigger" "relay_rtv3_boss_attack_start,Trigger,,36,1"
}

;==================================================
; Add RTV 4 - ⚠︎⚠︎⚠︎ HIGH CHANCE OF CRASHING ⚠︎⚠︎⚠︎
;==================================================

; Add rtv4 trigger
modify:
{
    match:
    {
        "targetname" "first_trigger"
    }
    insert:
    {
        "OnStartTouch" "rtv4_start,Trigger,,0,1"
    }
}
add:
{
    "classname" "logic_relay"
    "targetname" "rtv4_init"
    "spawnflags" "2"
    "StartDisabled" "0"
    "OnTrigger" "l1_first_trigger,Kill,,0,1"
    "OnTrigger" "l2_first_trigger,Kill,,0,1"
    "OnTrigger" "l3_first_trigger,Kill,,0,1"
    "OnTrigger" "l4_first_trigger,Kill,,0,1"
    "OnTrigger" "relay_rtv2_start,Kill,,0,1"
    "OnTrigger" "relay_rtv_first_trigger,Kill,,0,1"
    "OnTrigger" "relay_rtv3_first_trigger,kill,,0,1"
    "OnTrigger" "rtv4_start,Enable,,0,1"
    "OnTrigger" "l4_boss_bgm,PlaySound,,0,1"
    "OnTrigger" "rtv4_start,Trigger,,25.75,1"
    "Ontrigger" "bgm1,Kill,,0,1"
}

; Add rtv4 trigger relay
add:
{
    "classname" "logic_relay"
    "targetname" "rtv4_start"
    "spawnflags" "1"
    "StartDisabled" "1"
    "OnTrigger" "relay_st4_boss_kill,Kill,,0,-1"
    "OnTrigger" "relay_st4_boss_teleport_ready,Kill,,0,-1"
    "OnTrigger" "relay_st4_boss_case_return,Kill,,0,-1"
    "OnTrigger" "counter_st4_boss_vida,Kill,,0,-1"
    "OnTrigger" "counter_st4_boss_vida_bar,Kill,,0,-1"
    "OnTrigger" "l4_door_1,Open,,0,-1"
    "OnTrigger" "l4_door_1,Close,,10,-1"
    "OnTrigger" "fade_green,Fade,,10,-1"
    "OnTrigger" "l4_move_1,Open,,12,-1"
    "OnTrigger" "rtv_timer,Disable,,10,-1"
    "OnTrigger" "sc,Command,say *** AHH.. SH#T ***,16,-1"
    "OnTrigger" "sc,Command,say *** HERE WE GO AGAIN ***,19,-1"
    "OnTrigger" "fade_black_long,Fade,,23,-1"
    "OnTrigger" "fade_black_long,FadeReverse,,25,-1"
    "OnTrigger" "teleport_st4_boss_zm_spawn,Enable,,25,-1"
    "OnTrigger" "fade_black_long,FadeReverse,,27,-1"
    "OnTrigger" "cc_boss,Enable,,27,-1"
    "OnTrigger" "cc1,Disable,,27,-1"

    ; set default human HP
    "OnTrigger" "trigger_st4_boss_human_hp_up,AddOutput,OnStartTouch !activator:AddOutput:health 350:0.01:-1,30,1"
    "OnTrigger" "trigger_st4_boss_human_hp_up,Enable,,31,-1"
    "OnTrigger" "trigger_st4_boss_human_hp_up,Disable,,31.9,-1"
    "OnTrigger" "fade_white_15,Fade,,32,-1"
    "OnTrigger" "fade_white_15,FadeReverse,,33.5,-1"
    "OnTrigger" "relay_st4_boss_time_1,Kill,,34,-1"
    "OnTrigger" "l4_boss_bgm,FadeOut,3,33,-1"

    ; disable zombie respawn to prevent server edict crash
    ;"OnTrigger" "sc,Command,zr_respawn 0,36,-1"

    ; start the game!!
    "OnTrigger" "rtv4_attack,Enable,,35,-1"
    "OnTrigger" "rtv4_attack,Trigger,,36,1"
}
add:
{
    "model" "*572"
    "classname" "trigger_multiple"
    "targetname" "rtv4_win"
    "spawnflags" "1"
    "StartDisabled" "1"
    "wait" "1"
    "filtername" "human"
    "Origin" "-5906 9790 -410"
    "OnStartTouch" "relay_rtv_first_trigger,CancelPending,,0,-1"
    "OnStartTouch" "hurt_rtv2_zm_kill,Enable,,3,-1"

    ; reset back to rtv 1
    "OnStartTouch" "level_counter,SetValue,5,-1"

    ; turn on zombie respawn
    ;"OnStartTouch" "sc,Command,zr_respawn 1,5,-1"
}
add:
{
    "model" "*572"
    "classname" "trigger_multiple"
    "targetname" "rtv4_last_hp"
    "spawnflags" "1"
    "StartDisabled" "1"
    "wait" "1"
    "filtername" "human"
    "Origin" "-5906 9790 -440"
    "OnStartTouch" "!activator,AddOutput,Health 100,0,-1"
}

; Add rtv4 music
add:
{
    "classname" "ambient_generic"
    "cspinup" "0"
    "fadeinsecs" "0"
    "fadeoutsecs" "0"
    "health" "10"
    "lfomodpitch" "0"
    "lfomodvol" "0"
    "lforate" "0"
    "lfotype" "0"
    "message" "#koen/gris/ourovoros.mp3"
    "pitch" "100"
    "pitchstart" "100"
    "preset" "0"
    "radius" "1250"
    "spawnflags" "49"
    "spindown" "0"
    "spinup" "0"
    "targetname" "bgm_rtv4"
    "volstart" "0"
}

; Add rtv4 relay - meteor attack
add:
{
    "classname" "logic_relay"
    "targetname" "rtv4_ring_spawn"
    "spawnflags" "0"
    "StartDisabled" "0"
    "OnTrigger" "maker_st4_boss_3rd_special_white_end,ForceSpawnAtEntityOrigin,move_st4_boss_3rd_special_up_right,0,-1"
    "OnTrigger" "maker_st4_boss_3rd_special_white_end,ForceSpawnAtEntityOrigin,move_st4_boss_3rd_special_up_left,0,-1"
    "OnTrigger" "maker_st4_boss_3rd_special_white_end,ForceSpawnAtEntityOrigin,move_st4_boss_3rd_special_up_m,0,-1"
    "OnTrigger" "maker_st4_boss_3rd_special_white_end,ForceSpawnAtEntityOrigin,move_st4_boss_3rd_special_up_u,0,-1"
}
add:
{
    "targetname" "case_rtv4_ring_spawn_random"
    "classname" "logic_case"
    "OnCase01" "rtv4_ring_spawn,Trigger,,0,-1"
    "OnCase02" "rtv4_ring_spawn,Trigger,,0,-1"
    "OnCase03" "rtv4_ring_spawn,Trigger,,0,-1"
    "OnCase03" "rtv4_ring_spawn,Trigger,,0.03,-1"
}

; Add rtv4 relay - enable meteor damage
add:
{
    "classname" "logic_relay"
    "targetname" "rtv4_ring_dmg"
    "spawnflags" "0"
    "StartDisabled" "0"
    "OnTrigger" "hurt_st4_boss_3rd2_special_beam,Enable,,0.05,-1"
    "OnTrigger" "beam_st4_boss_3rd2_special_beam_1,TurnOn,,0,-1"
    "OnTrigger" "beam_st4_boss_3rd2_special_beam_2,TurnOn,,0,-1"
    "OnTrigger" "beam_st4_boss_3rd2_special_beam_3,TurnOn,,0,-1"
    "OnTrigger" "beam_st4_boss_3rd2_special_beam_4,TurnOn,,0,-1"
    "OnTrigger" "laser_se_2,PlaySound,,0,-1"
    "OnUser1" "hurt_st4_boss_3rd2_special_beam,AddOutput,DamageCap 50,0.01,-1"
    "OnUser1" "hurt_st4_boss_3rd2_special_beam,AddOutput,Damage 100,0.01,-1"
    "OnUser1" "!self,Trigger,,0,-1"
}
add:
{
    "classname" "logic_relay"
    "targetname" "rtv4_ring_remove"
    "spawnflags" "0"
    "StartDisabled" "0"
    "OnTrigger" "target_st4_boss_3rd2_special_beam_*,Kill,,0.1,-1"
    "OnTrigger" "relay_st4_boss_3rd_special_white_end*,Kill,,0.1,-1"
    "OnTrigger" "hurt_st4_boss_3rd2_special_beam*,kill,,0.1,-1"
    "OnTrigger" "laser_se_2,FadeOut,1,1,-1"
    "OnTrigger" "beam_st4_boss_3rd2_special_ring*,kill,,0.1,-1"
    "OnTrigger" "beam_st4_boss_3rd2_special_beam_*,kill,,0.1,-1"
    "OnTrigger" "target_st4_boss_3rd2_special_attack_*,Kill,,0.1,-1"
    "OnTrigger" "beam_st4_boss_3rd2_special_ring*,TurnOff,,0,-1"
}
add:
{
    "targetname" "rtv4_guruguru"
    "classname" "logic_relay"
    "spawnflags" "2"
    "StartDisabled" "0"
    "OnTrigger" "temp_st4_boss_guruguru,ForceSpawn,,0,-1"
    "OnTrigger" "se1,playsound,,0,-1"
    "OnTrigger" "fade_white,Fade,,0,-1"
    "OnTrigger" "fade_white,Fade,,3,-1"
    "OnTrigger" "laser_se_2,PlaySound,,3,-1"
}
add:
{
    "classname" "logic_relay"
    "targetname" "rtv4_guruguru_remove"
    "spawnflags" "2"
    "StartDisabled" "0"
    "OnTrigger" "hurt_st4_boss_guruguru_*,Kill,,0,-1"
    "OnTrigger" "rot_st4_boss_guruguru,Kill,,0,-1"
    "OnTrigger" "move_st4_boss_guruguru_tb,Kill,,0,-1"
    "OnTrigger" "move_st4_boss_guruguru_*,Kill,,0,-1"
    "OnTrigger" "laser_st4_boss_guruguru_*,Kill,,0,-1"
    "OnTrigger" "target_st4_boss_guruguru_*,Kill,,0,-1"
    "OnTrigger" "relay_st4_boss_guruguru_activate,Kill,,0,-1"
    "OnTrigger" "fade_white,Fade,,0,-1"
}

; Add rtv4 relay - end disco attack
add:
{
    "classname" "logic_relay"
    "targetname" "rtv4_disco_end"
    "spawnflags" "2"
    "StartDisabled" "0"
    "OnTrigger" "laser_se_2,FadeOut,1,0,-1"
    "OnTrigger" "fade_white,Fade,,0,-1"
    "OnTrigger" "beam_st4_boss_disco_*,Kill,,0,-1"
    "OnTrigger" "target_st4_boss_disco_*,Kill,,0,-1"
    "OnTrigger" "move_st4_boss_disco_b*,Kill,,0,-1"
    "OnTrigger" "hurt_st4_boss_disco_*,Kill,,0,-1"
    "OnTrigger" "rot_st4_boss_disco*,Kill,,0,-1"
    "OnTrigger" "relay_st4_boss_disco_activate,Kill,,0,-1"
}
add:
{
    "targetname" "relay_rtv4_vortex_rev"
    "classname" "logic_relay"
    "SpawnFlags" "2"
    "StartDisabled" "0"
    "OnTrigger" "relay_st4_boss_vortex,AddOutput,OnUser1 se13:PlaySound::0.5:-1,,0,-1"
    "OnTrigger" "relay_st4_boss_vortex,AddOutput,OnUser1 se11:fadeout:1:0.01:-1,,0,-1"
    "OnTrigger" "relay_st4_boss_vortex,Trigger,,0.03,-1"
    "OnTrigger" "relay_st4_boss_vortex,FireUser1,,0.03,-1"
}
add:
{
    "targetname" "relay_rtv4_push_rev"
    "classname" "logic_relay"
    "SpawnFlags" "2"
    "StartDisabled" "0"
    "OnTrigger" "relay_st4_boss_push,AddOutput,OnUser1 se11:PlaySound::0.1:-1,,0,-1"
    "OnTrigger" "relay_st4_boss_push,AddOutput,OnUser1 se13:fadeout:1:0:-1,,0,-1"
    "OnTrigger" "relay_st4_boss_push,Trigger,,0.03,-1"
    "OnTrigger" "relay_st4_boss_push,FireUser1,,0.03,-1"
}
add:
{
    "classname" "logic_case"
    "targetname" "rtv4_vortex_push"
    "OnCase01" "relay_st4_boss_push,Trigger,,0.03,-1"
    "OnCase02" "relay_st4_boss_vortex,Trigger,,0.03,-1"
    "OnCase03" "relay_rtv4_vortex_rev,Trigger,,0,-1"
    "OnCase04" "relay_rtv4_push_rev,Trigger,,0,-1"
}
add:
{
    "targetname" "rtv4_under_rot"
    "classname" "logic_relay"
    "spawnflags" "2"
    "startdisabled" "0"
    "OnTrigger" "temp_rtv2_under_rot,ForceSpawn,,0,-1"
    "OnTrigger" "rot_rtv2_under_rota,AddOutput,Maxspeed 40,0.1,-1"
    "OnTrigger" "rot_rtv2_under_rota,SetSpeed,40,0.2,-1"
}
add:
{
    "targetname" "rtv4_attack_random2"
    "classname" "logic_case"
    "OnCase01" "relay_st4_boss_vortex_push,Trigger,,3,-1"
    "OnCase01" "relay_st4_boss_lines_start,Trigger,,0,-1"
    "OnCase01" "relay_st4_boss_guruguru,Trigger,,0,-1"
    "OnCase02" "relay_st4_boss_ikura_spawn,Trigger,,0,-1"
    "OnCase02" "rtv4_vortex_push,PickRandom,,4,-1"
    "OnCase02" "relay_st4_boss_disco,Trigger,,0,-1"
}
add:
{
    "targetname" "rtv4_attack_random1"
    "classname" "logic_case"
    "OnCase01" "relay_st4_boss_under_circle,Trigger,,0,-1"
    "OnCase01" "relay_st4_boss_circle_lasers,Trigger,,0,-1"
    "OnCase01" "relay_st4_boss_asimoto_dokkan_start,Trigger,,0,-1"
    "OnCase02" "relay_st4_boss_circle_lasers,Trigger,,0,-1"
    "OnCase02" "relay_st4_boss_under_circle,Trigger,,0,-1"
    "OnCase02" "rtv4_vortex_push,PickRandom,,4,-1"
}
add:
{
    "model" "*497"
    "targetname" "rt4_healer"
    "classname" "trigger_hurt"
    "startdisabled" "1"
    "spawnflags" "1"
    "origin" "-12928 5888 12824"
    "nodmgforce" "0"
    "damagetype" "1024"
    "damagemodel" "0"
    "damagecap" "-5"
    "damage" "-10"
}
add:
{
    "targetname" "rtv4_healer_time"
    "classname" "logic_timer"
    "userandomtime" "0"
    "refiretime" "3"
    "startdisabled" "1"
    "spawnflags" "0"
    "OnTimer" "rt4_healer,Enable,,0,-1"
    "OnTimer" "rt4_healer,Disable,,0.4,-1"
}

; Add rtv4 relay - lower reverse laser
add:
{
    "classname" "env_beam"
    "BoltWidth" "14"
    "ClipStyle" "0"
    "damage" "0"
    "decalname" "Bigshot"
    "framerate" "0"
    "framestart" "0"
    "HDRColorScale" "1.0"
    "life" "1"
    "LightningEnd" "move_rtv4_last_laser_21"
    "LightningStart" "move_rtv4_last_laser_11"
    "NoiseAmplitude" "0"
    "Radius" "256"
    "renderamt" "255"
    "rendercolor" "255 0 0"
    "renderfx" "0"
    "spawnflags" "9"
    "StrikeTime" "0"
    "targetname" "beam_rtv4_laser_1"
    "targetpoint" "-5902 11730 -508"
    "texture" "sprites/laserbeam.spr"
    "TextureScroll" "35"
    "TouchType" "0"
    "origin" "-5902 11729 -508"
}
add:
{
    "classname" "func_movelinear"
    "blockdamage" "0"
    "disablereceiveshadows" "0"
    "fademaxdist" "0"
    "fademindist" "-1"
    "fadescale" "1"
    "movedir" "0 270 0"
    "movedistance" "3000"
    "origin" "-5890 11700 -516"
    "renderamt" "255"
    "rendercolor" "255 255 255"
    "renderfx" "0"
    "rendermode" "0"
    "spawnflags" "8"
    "speed" "1999"
    "startposition" "0"
    "targetname" "move_rtv4_last_laser_11"
    "model" "*563"
}
add:
{
    "classname" "func_movelinear"
    "blockdamage" "0"
    "disablereceiveshadows" "0"
    "fademaxdist" "0"
    "fademindist" "-1"
    "fadescale" "1"
    "movedir" "0 90 0"
    "movedistance" "3000"
    "origin" "-5890 11750 -516"
    "renderamt" "255"
    "rendercolor" "255 255 255"
    "renderfx" "0"
    "rendermode" "0"
    "spawnflags" "8"
    "speed" "1999"
    "startposition" "0"
    "targetname" "move_rtv4_last_laser_21"
    "model" "*564"
    "OnFullyOpen" "move_rtv4_last_laser_21,Kill,,0,-1"
    "OnFullyOpen" "move_rtv4_last_laser_11,Kill,,0,-1"
    "OnFullyOpen" "beam_rtv4_laser_1,Kill,,0,-1"
    "OnFullyOpen" "hurt_rtv4_last_laser_1,Kill,,0,-1"
}
add:
{
    "classname" "trigger_hurt"
    "damage" "300"
    "damagecap" "20"
    "damagemodel" "0"
    "damagetype" "1024"
    "nodmgforce" "0"
    "origin" "-5890 11736 -458"
    "parentname" "move_rtv4_last_laser_11"
    "spawnflags" "4097"
    "StartDisabled" "0"
    "targetname" "hurt_rtv4_last_laser_1"
    "model" "*562"
}
add:
{
    "classname" "logic_relay"
    "spawnflags" "0"
    "StartDisabled" "0"
    "targetname" "relay_rtv4_last_lasers_1"
    "OnSpawn" "move_rtv4_last_laser_11,Open,,0,-1"
    "OnSpawn" "!self,Kill,,0,-1"
    "OnSpawn" "beam_rtv4_laser_1,TurnOn,,0,-1"
    "OnSpawn" "move_rtv4_last_laser_21,Open,,0,-1"
}
add:
{
    "targetname" "temp_rtv4_last_laser_1"
    "classname" "point_template"
    "template03" "beam_rtv4_laser_1"
    "template04" "relay_rtv4_last_lasers_1"
    "template05" "hurt_rtv4_last_laser_1"
    "template06" "move_rtv4_last_laser_11"
    "template07" "move_rtv4_last_laser_21"
    "spawnflags" "0"
    "Origin" "-5890 11725 -516"
}
add:
{
    "origin" "-5890 11749 -516"
    "targetname" "maker_rtv4_last_laser_1"
    "classname" "env_entity_maker"
    "angles" "0 0 0"
    "EntityTemplate" "temp_rtv4_last_laser_1"
    "PostSpawnDirection" "0 0 0"
    "PostSpawnDirectionVariance" "0 0 0"
    "PostSpawnInheritAngles" "0"
    "PostSpawnSpeed" "0"
    "spawnflags" "0"
}

; Add rtv4 relay - upper reverse laser
add:
{
    "classname" "env_beam"
    "BoltWidth" "14"
    "ClipStyle" "0"
    "damage" "0"
    "decalname" "Bigshot"
    "framerate" "0"
    "framestart" "0"
    "HDRColorScale" "1.0"
    "life" "1"
    "LightningEnd" "move_rtv4_last_laser_22"
    "LightningStart" "move_rtv4_last_laser_12"
    "NoiseAmplitude" "0"
    "Radius" "256"
    "renderamt" "255"
    "rendercolor" "255 0 0"
    "renderfx" "0"
    "spawnflags" "9"
    "StrikeTime" "0"
    "targetname" "beam_rtv4_laser_2"
    "targetpoint" "-5902 11730 -518"
    "texture" "sprites/laserbeam.spr"
    "TextureScroll" "35"
    "TouchType" "0"
    "origin" "-5902 11729 -518"
}
add:
{
    "classname" "func_movelinear"
    "blockdamage" "0"
    "disablereceiveshadows" "0"
    "fademaxdist" "0"
    "fademindist" "-1"
    "fadescale" "1"
    "movedir" "0 270 0"
    "movedistance" "3000"
    "origin" "-5890 11700 -458"
    "renderamt" "255"
    "rendercolor" "255 255 255"
    "renderfx" "0"
    "rendermode" "0"
    "spawnflags" "8"
    "speed" "1999"
    "startposition" "0"
    "targetname" "move_rtv4_last_laser_12"
    "model" "*563"
}
add:
{
    "classname" "func_movelinear"
    "blockdamage" "0"
    "disablereceiveshadows" "0"
    "fademaxdist" "0"
    "fademindist" "-1"
    "fadescale" "1"
    "movedir" "0 90 0"
    "movedistance" "3000"
    "origin" "-5890 11750 -458"
    "renderamt" "255"
    "rendercolor" "255 255 255"
    "renderfx" "0"
    "rendermode" "0"
    "spawnflags" "8"
    "speed" "1999"
    "startposition" "0"
    "targetname" "move_rtv4_last_laser_22"
    "model" "*564"
    "OnFullyOpen" "move_rtv4_last_laser_22,Kill,,0,-1"
    "OnFullyOpen" "move_rtv4_last_laser_12,Kill,,0,-1"
    "OnFullyOpen" "beam_rtv4_laser_1,Kill,,0,-1"
    "OnFullyOpen" "hurt_rtv4_last_laser_2,Kill,,0,-1"
}
add:
{
    "classname" "trigger_hurt"
    "damage" "300"
    "damagecap" "20"
    "damagemodel" "0"
    "damagetype" "1024"
    "nodmgforce" "0"
    "origin" "-5890 11736 -516"
    "parentname" "move_rtv4_last_laser_12"
    "spawnflags" "4097"
    "StartDisabled" "0"
    "targetname" "hurt_rtv4_last_laser_2"
    "model" "*562"
}
add:
{
    "classname" "logic_relay"
    "spawnflags" "0"
    "StartDisabled" "0"
    "targetname" "relay_rtv4_last_lasers_2"
    "OnSpawn" "move_rtv4_last_laser_12,Open,,0,-1"
    "OnSpawn" "!self,Kill,,0,-1"
    "OnSpawn" "beam_rtv4_laser_2,TurnOn,,0,-1"
    "OnSpawn" "move_rtv4_last_laser_22,Open,,0,-1"
}
add:
{
    "targetname" "temp_rtv4_last_laser_2"
    "classname" "point_template"
    "template03" "beam_rtv4_laser_2"
    "template04" "relay_rtv4_last_lasers_2"
    "template05" "hurt_rtv4_last_laser_2"
    "template06" "move_rtv4_last_laser_12"
    "template07" "move_rtv4_last_laser_22"
    "spawnflags" "0"
    "Origin" "-5890 11725 -458"
}
add:
{
    "origin" "-5890 11749 -458"
    "targetname" "maker_rtv4_last_laser_2"
    "classname" "env_entity_maker"
    "angles" "0 0 0"
    "EntityTemplate" "temp_rtv4_last_laser_2"
    "PostSpawnDirection" "0 0 0"
    "PostSpawnDirectionVariance" "0 0 0"
    "PostSpawnInheritAngles" "0"
    "PostSpawnSpeed" "0"
    "spawnflags" "0"
}
add:
{
    "targetname" "fade_red"
    "classname" "env_fade"
    "duration" "1"
    "holdtime" "0"
    "renderamt" "45"
    "rendercolor" "255 0 0"
    "ReverseFadeDuration" "2"
    "spawnflags" "1"
}

; Add rtv4 main relay
add:
{
    "targetname" "rtv4_attack"
    "classname" "logic_relay"
    "spawnflags" "1"
    "startdisabled" "1"

    ; add new reverse laser attack
    "OnTrigger" "case_rtv2_last_laser_random,AddOutput,OnCase04 maker_rtv4_last_laser_1:ForceSpawn::0:-1,0,-1"
    "OnTrigger" "case_rtv2_last_laser_random,AddOutput,OnCase04 laser_se_2:playsound::0:-1,0,-1"
    "OnTrigger" "case_rtv2_last_laser_random,AddOutput,OnCase04 fade_red:fade::0:-1,0,-1"
    "OnTrigger" "case_rtv2_last_laser_random,AddOutput,OnCase05 maker_rtv4_last_laser_2:ForceSpawn::0:-1,0,-1"
    "OnTrigger" "case_rtv2_last_laser_random,AddOutput,OnCase05 laser_se_2:playsound::0:-1,0,-1"
    "OnTrigger" "case_rtv2_last_laser_random,AddOutput,OnCase05 fade_red:fade::0:-1,0,-1"
    "OnTrigger" "fade_red,AddOutput,RenderAmt 46,0,-1"

    ; enable all boss skill relays
    "OnTrigger" "relay_st4_boss_case_return,Kill,,0,-1"
    "OnTrigger" "relay_st4_boss_under_circle,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_guruguru,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_vortex,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_push,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_vortex_push,Enable,,0,-1"
    ;"OnTrigger" "relay_st4_boss_go_lasers,Enable,,0,-1"
    ;"OnTrigger" "relay_st4_boss_go_lasers_back,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_circle_lasers,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_ikura_spawn,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_zombie_ring,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_asimoto_dokkan_start,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_lines_start,Enable,,0,-1"
    "OnTrigger" "relay_st4_boss_disco,Enable,,0,-1"
    "OnTrigger" "rot_st4_boss_3rd_special_under_spawn,AddOutput,Origin -12932 5898 13944,0,-1"
    "OnTrigger" "player,AddOutput,max_health 150,0,-1"

    ; fix vortex/push being too blinding
    "OnTrigger" "relay_st4_boss_push,AddOutput,OnTrigger cc_boss:Enable::0.6:-1,0,1"
    "OnTrigger" "relay_st4_boss_vortex,AddOutput,OnTrigger cc_boss:Enable::0.1:-1,0,1"
    "OnTrigger" "relay_st4_boss_vortex_push,AddOutput,OnTrigger cc_boss:Enable::0.1:-1,0,1"
    "OnTrigger" "timer_st4_last_huyuu,Enable,,0,-1"
    "OnTrigger" "rot_st4_last_sky,startforward,,0,-1"

    ; enable fast retrigger for relays
    "OnTrigger" "relay_st4_boss_push,AddOutput,spawnflags 2,0,1"
    "OnTrigger" "relay_st4_boss_vortex,AddOutput,spawnflags 2,0,1"
    "OnTrigger" "relay_st4_boss_under_circle,AddOutput,spawnflags 2,0,1"
    "OnTrigger" "relay_st4_boss_guruguru,AddOutput,spawnflags 2,0,1"
    "OnTrigger" "relay_st4_boss_vortex_push,AddOutput,spawnflags 2,0,1"
    "OnTrigger" "relay_st4_boss_circle_lasers,AddOutput,spawnflags 2,0,1"
    "OnTrigger" "relay_st4_boss_lines_start,AddOutput,spawnflags 2,0,1"
    "OnTrigger" "relay_st4_boss_disco,AddOutput,spawnflags 2,0,1"
    "OnTrigger" "relay_st4_boss_asimoto_dokkan_start,AddOutput,spawnflags 2,0,1"
    "OnTrigger" "bgm_rtv4,PlaySound,,0,-1,"

    ; 1st phase
    "OnTrigger" "case_move_st4_boss_3rd_special_up_random,PickRandom,,3.3,-1"
    "OnTrigger" "case_rot_st4_boss_3rd_special_under_spawn2,PickRandom,,3.3,-1"
    "OnTrigger" "timer_rot_st4_boss_3rd_special_under_spawn,Enable,,0,-1"
    "OnTrigger" "case_rtv4_ring_spawn_random,PickRandom,,5.3,-1"
    "OnTrigger" "case_rtv4_ring_spawn_random,PickRandom,,6,-1"
    "OnTrigger" "case_rtv4_ring_spawn_random,PickRandom,,6.6,-1"
    "OnTrigger" "case_rtv4_ring_spawn_random,PickRandom,,7.3,-1"
    "OnTrigger" "case_rtv4_ring_spawn_random,PickRandom,,7.9,-1"
    "OnTrigger" "case_rtv4_ring_spawn_random,PickRandom,,8.5,-1"
    "OnTrigger" "case_rtv4_ring_spawn_random,PickRandom,,9.3,-1"
    "OnTrigger" "case_rtv4_ring_spawn_random,PickRandom,,9.93,-1"
    "OnTrigger" "rtv4_ring_dmg,Trigger,,10.5,-1"
    "OnTrigger" "rtv4_ring_remove,Trigger,,11,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,2.3,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,3,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,3.6,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,4.3,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,4.9,-1"
    "OnTrigger" "rtv4_disco_end,Trigger,,17.3,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,11.77,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,12.4,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,13.1,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,13.7,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,14.2,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,14.4,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,14.6,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,14.8,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,15,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,15.2,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,15.4,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,15.6,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,15.8,-1"
    "OnTrigger" "rtv4_ring_spawn,Trigger,,16,-1"
    "OnTrigger" "rtv4_ring_dmg,Trigger,,16,-1"
    "OnTrigger" "rtv4_ring_remove,Trigger,,17.2,-1"
    "OnTrigger" "timer_rot_st4_boss_3rd_special_under_spawn,Disable,,18,-1,"
    "OnTrigger" "case_st4_boss_go_lasers,PickRandom,,16,-1"

    ; 2nd phase
    "OnTrigger" "relay_st4_boss_vortex_push,Trigger,,20.1,-1"
    "OnTrigger" "timer_st4_boss_lines,Enable,,26,-1"
    "OnTrigger" "rtv4_guruguru,trigger,,26,-1"
    "OnTrigger" "rtv4_vortex_push,PickRandom,,30.3,-1"
    "OnTrigger" "rtv4_vortex_push,PickRandom,,31.4,-1"
    "OnTrigger" "rtv4_guruguru_remove,Trigger,,37,-1"
    "OnTrigger" "st4_boss_cc,Enable,,37,-1"
    "OnTrigger" "rtv4_under_rot,trigger,,37,-1"
    "OnTrigger" "rtv4_vortex_push,PickRandom,,41.3,-1"
    "OnTrigger" "rtv4_vortex_push,PickRandom,,42.4,-1"
    "OnTrigger" "st4_boss_cc,Disable,,47,-1"
    "OnTrigger" "relay_rtv2_boss_under_rot_killer,Trigger,,47,-1"
    "OnTrigger" "timer_st4_boss_lines,Disable,,47,-1"
    "OnTrigger" "se20,FadeOut,1,47,-1"

    ; 3rd phase
    "OnTrigger" "rtv4_attack_random1,PickRandomShuffle,,47.1,-1"
    "OnTrigger" "st4_boss_cc,Enable,,57.3,-1"
    "OnTrigger" "rtv4_disco_end,Trigger,,57.3,-1"
    "OnTrigger" "rtv4_guruguru_remove,Trigger,,57.3,-1"
    "OnTrigger" "timer_st4_boss_lines,Disable,,57.3,-1"
    "OnTrigger" "move_st4_boss_under_circle_*,Kill,,57.3,-1"
    "OnTrigger" "laser_st4_boss_under_circle_lasers_*,Kill,,57.3,-1"
    "OnTrigger" "relay_St4_boss_under_circle_activate,Kill,,57.3,-1"
    "OnTrigger" "temp_rtv2_boss_spawn_ikura,ForceSpawn,,57.3,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,59.4,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,60.71,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,62.1,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,63.4,-1"
    "OnTrigger" "case_st4_boss_disco_point,PickRandomShuffle,,64.6,-1"
    "OnTrigger" "rtv4_disco_end,Trigger,,72,-1"
    "OnTrigger" "relay_rtv2_boss_ikura_killer,Trigger,,72,-1"
    "OnTrigger" "st4_boss_cc,Disable,,72,-1"

    ; 4th phase
    "OnTrigger" "timer_rot_st4_boss_3rd_special_under_spawn,Enable,,72,-1"
    "OnTrigger" "timer_st4_boss_3rd_special_white_beam_end,AddOutput,OnTimer maker_st4_boss_3rd_special_white_end:ForceSpawnAtEntityOrigin:move_st4_boss_3rd_special_up_u:0:-1,0,-1"
    "OnTrigger" "timer_st4_boss_3rd_special_white_beam_end,Enable,,72.5,-1"
    "OnTrigger" "timer_st4_boss_3rd_special_white_beam_end,Disable,,76.8,-1"
    "OnTrigger" "rtv4_ring_dmg,FireUser1,,77.8,-1"
    "OnTrigger" "timer_rot_st4_boss_3rd_special_under_spawn,Disable,,76,-1,"
    "OnTrigger" "shake_st4_boss,StartShake,,77.8,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,77.8,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,77.8,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,77.8,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,77.8,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,77.8,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,77.8,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,77.8,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,77.8,-1"
    "OnTrigger" "shake_st4_boss,StartShake,,77.8,-1"
    "OnTrigger" "shake_st4_boss,StopShake,,79.1,-1"
    "OnTrigger" "rtv4_ring_remove,Trigger,,79.1,-1"

    ; 5th phase
    "OnTrigger" "rtv4_attack_random1,PickRandomShuffle,,79,-1"
    "OnTrigger" "rtv4_attack_random2,PickRandomShuffle,,88.3,-1"
    "OnTrigger" "relay_rtv2_boss_ikura_killer,Trigger,,102,-1"
    "OnTrigger" "rtv4_disco_end,Trigger,,102,-1"
    "OnTrigger" "relay_st4_boss_zombie_ring,Trigger,,101,-1"
    "OnTrigger" "rtv4_healer_time,Enable,,101,-1"
    "OnTrigger" "rtv4_healer_time,Disable,,130,-1"
    "OnTrigger" "rtv4_attack_random2,PickRandomShuffle,,115.4,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,128.60,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,128.74,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,129.03,-1"
    "OnTrigger" "relay_rtv3_boss_spawn_circle,Trigger,,129.37,-1"
    "OnTrigger" "relay_rtv3_boss_circle_active,Trigger,,129.93,-1"
    "OnTrigger" "relay_rtv3_boss_circle_clear,Trigger,,130.5,-1"

    ; 6th phase
    "OnTrigger" "fade_white_15,Fade,,130.5,-1"
    "OnTrigger" "fade_white_15,FadeReverse,,132,-1"
    "OnTrigger" "st4_boss_cc,Disable,,131,-1"
    "OnTrigger" "teleport_st4_boss_human,Enable,,131.5,-1"
    "OnTrigger" "destination_st4_boss_human,AddOutput,Origin -5892 9738 -486,131.3,-1"
    "OnTrigger" "teleport_st4_boss_zm,Enable,,131.4,-1"
    "OnTrigger" "destination_st4_boss_zm,AddOutput,origin -5964 7784 -408,131.3,-1"
    "OnTrigger" "destination_st4_boss_human,AddOutput,angles 0 90 0,131.2,-1"
    "OnTrigger" "destination_st4_boss_zm,AddOutput,angles 0 90 0,131.2,-1"
    "OnTrigger" "teleport_st4_boss_zm,AddOutput,landmark teleport_st4_boss_zm,131.2,-1"
    "OnTrigger" "tonemap,SetAutoExposureMax,0.8,131.5,-1"
    "OnTrigger" "tonemap,SetAutoExposureMin,0.8,131.5,-1"
    "OnTrigger" "tonemap,SetBloomScale,0.5,131.5,-1"
    "OnTrigger" "ppc,SetLocalContrastStrength,-1.8,131.5,-1"
    "OnTrigger" "cc_boss,Disable,,131,-1"
    "OnTrigger" "rot_rtv2_last_laser,StartForward,,131.5,-1"
    "OnTrigger" "rot_con_last_asiba,StartForward,,131.5,-1"
    "OnTrigger" "brush_st4_last_sky,Enable,,130,-1,"
    "OnTrigger" "timer_st4_last_huyuu,Disable,,138.9,-1"
    "OnTrigger" "move_st4_last_huyuu_3nin*,SetSpeed,1200,139,-1"
    "OnTrigger" "move_st4_last_huyuu_3nin*,Close,,139.1,-1"
    "OnTrigger" "rtv4_last_hp,Enable,,134,-1"
    "OnTrigger" "rtv4_last_hp,Disable,,134.1,-1"
    "OnTrigger" "case_rtv2_last_laser_random,PickRandom,,135,-1"
    "OnTrigger" "case_rtv2_last_laser_random,PickRandom,,136.3,-1"
    "OnTrigger" "case_rtv2_last_laser_random,PickRandom,,137.7,-1"
    "OnTrigger" "case_rtv2_last_laser_random,PickRandom,,138.4,-1"
    "OnTrigger" "case_rtv2_last_laser_random,PickRandom,,139.1,-1"
    "OnTrigger" "case_rtv2_last_laser_random,PickRandom,,139.8,-1"
    "OnTrigger" "case_rtv2_last_laser_random,PickRandom,,140.5,-1"
    "OnTrigger" "laser_se_2,FadeOut,1,140.7,-1"
    "OnTrigger" "rtv4_win,Enable,,146.1,-1"
}